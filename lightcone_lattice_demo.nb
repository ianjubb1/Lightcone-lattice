(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    242196,       6699]
NotebookOptionsPosition[    228298,       6268]
NotebookOutlinePosition[    228634,       6283]
CellTagsIndexPosition[    228591,       6280]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Lightcone lattice demonstration", "Title",
 CellChangeTimes->{{3.7491168827512255`*^9, 3.749116888297022*^9}}],

Cell[CellGroupData[{

Cell["Basic definitions", "Section",
 CellChangeTimes->{{3.5613558008469133`*^9, 3.56135580506012*^9}}],

Cell[CellGroupData[{

Cell["Building blocks", "Subsubsection",
 CellChangeTimes->{{3.561899605375959*^9, 3.561899608300157*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mf", "=", "MatrixForm"}], ";", 
  RowBox[{"fs", "=", "FullSimplify"}], ";", 
  RowBox[{"KP", "=", "KroneckerProduct"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "I"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"I", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"id", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"O1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"O2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AC", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"x", ".", "y"}], "+", 
   RowBox[{"y", ".", "x"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"x", ".", "y"}], "-", 
   RowBox[{"y", ".", "x"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZL", "[", "x_", "]"}], ":=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"Z", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZR", "[", "x_", "]"}], ":=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"x", ",", "Z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"idL", "[", "x_", "]"}], ":=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"id", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"idR", "[", "x_", "]"}], ":=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"x", ",", "id"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "\[Gamma]"}], "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Gamma]"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ass", "=", 
   RowBox[{"Element", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x", ",", "y", ",", "t", ",", "s", ",", "\[Gamma]", ",", "\[Theta]"}], 
      "}"}], ",", "Reals"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC", "[", "x_", "]"}], ":=", 
  RowBox[{"fs", "[", 
   RowBox[{
    RowBox[{"Conjugate", "[", "x", "]"}], ",", "ass"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC2", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"I", "\[Rule]", " ", 
      RowBox[{"-", "I"}]}], ",", 
     RowBox[{
      RowBox[{"-", "I"}], "\[Rule]", " ", "I"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HC", "[", "x__", "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"CC", "[", "x", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fsa", "[", "x_", "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"x", ",", "ass"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UK", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matrixProduct", "[", "listOfMatrices_", "]"}], ":=", 
   RowBox[{"Dot", "@@", "listOfMatrices"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.559306004877615*^9, 3.55930608856001*^9}, {
   3.559306474342697*^9, 3.5593064871596203`*^9}, {3.5593087426285763`*^9, 
   3.559308754495886*^9}, {3.559309006526136*^9, 3.559309028249042*^9}, {
   3.559316181146523*^9, 3.55931621663581*^9}, {3.561367491253237*^9, 
   3.5613675608589687`*^9}, {3.561367612688312*^9, 3.56136761464485*^9}, {
   3.561368367956698*^9, 3.5613683693737993`*^9}, {3.5613810496073303`*^9, 
   3.561381077968252*^9}, {3.5613811331168747`*^9, 3.5613811380325937`*^9}, {
   3.5613812198300467`*^9, 3.56138126369501*^9}, {3.561898901082457*^9, 
   3.561898906830966*^9}, {3.5618992121440983`*^9, 3.561899231342977*^9}, {
   3.561900697284689*^9, 3.56190071254908*^9}, {3.561901948883925*^9, 
   3.5619019526749496`*^9}, {3.561979852398176*^9, 3.56197988037956*^9}, 
   3.561981503028153*^9, {3.561986018006575*^9, 3.561986046821649*^9}, {
   3.5619860834620123`*^9, 3.561986135547118*^9}, {3.56282647558256*^9, 
   3.56282647585672*^9}, {3.562826578840279*^9, 3.5628265792109003`*^9}, 
   3.675505890264805*^9, 3.675505973037676*^9, {3.675523812584429*^9, 
   3.6755238127673607`*^9}, {3.675583444497731*^9, 3.675583446521963*^9}, {
   3.677758900381957*^9, 3.677758905551696*^9}, {3.677759469380608*^9, 
   3.677759489284275*^9}, {3.677760641302121*^9, 3.677760643295342*^9}, {
   3.678009669716247*^9, 3.678009670974681*^9}, {3.678436466168786*^9, 
   3.678436466425411*^9}, {3.678448937425447*^9, 3.678448938295848*^9}, 
   3.7491169355733824`*^9, {3.749287159799985*^9, 3.749287184939892*^9}, {
   3.756032515149613*^9, 3.7560325153048687`*^9}, {3.7560326826650743`*^9, 
   3.7560326837522*^9}, {3.758631188482307*^9, 3.758631190137252*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basis states", "Subsubsection",
 CellChangeTimes->{{3.749123074960678*^9, 3.749123088801227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"basisLists", "[", "N_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"IntegerDigits", "[", 
      RowBox[{"n", ",", "2", ",", "N"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{
        SuperscriptBox["2", "N"], "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.749191638477151*^9, 3.7491916515919037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"basisKets", "[", "N_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"Row", "[", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{"n", ",", "2", ",", "N"}], "]"}], ",", "\"\<,\>\""}], "]"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{
        SuperscriptBox["2", "N"], "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.749191632284185*^9, 3.749191632693321*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"basisKets", "[", "4", "]"}]], "Input",
 CellChangeTimes->{{3.749191657655727*^9, 3.749191665340179*^9}, {
  3.7492793903592787`*^9, 3.749279390950451*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
    TemplateBox[{",", "\",\"", "0", "0", "0", "0"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "0", "0", "0", "1"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "0", "0", "1", "0"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "0", "0", "1", "1"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "0", "1", "0", "0"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "0", "1", "0", "1"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "0", "1", "1", "0"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "0", "1", "1", "1"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "1", "0", "0", "0"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "1", "0", "0", "1"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "1", "0", "1", "0"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "1", "0", "1", "1"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "1", "1", "0", "0"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "1", "1", "0", "1"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "1", "1", "1", "0"}, "RowWithSeparators"]},
    "Ket"], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "1", "1", "1", "1"}, "RowWithSeparators"]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7491231375727153`*^9, 3.749191285732761*^9, 3.74919166605243*^9, 
   3.74919436324505*^9, {3.7492793870291643`*^9, 3.749279391870212*^9}, 
   3.749366970230042*^9, 3.749375847685401*^9, 3.756029388671794*^9, 
   3.758631096281291*^9, 3.7586312059941053`*^9}]
}, Open  ]],

Cell["\<\
Function to translate from normal vector to one with kets (for readability)\
\>", "Text",
 CellChangeTimes->{{3.756029903294257*^9, 3.756029922789928*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vectorToBasisKets", "[", "vec_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"numberOfSites", "=", 
       RowBox[{"Log", "[", 
        RowBox[{"2", ",", 
         RowBox[{"Length", "[", "vec", "]"}]}], "]"}]}], ",", 
      "basisKetsVector", ",", "outputVector"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"basisKetsVector", "=", 
      RowBox[{"basisKets", "[", "numberOfSites", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"outputVector", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vec", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"basisKetsVector", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "basisKetsVector", "]"}]}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Total", "[", "outputVector", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.756029617128682*^9, 3.756029724333459*^9}, {
  3.756029789935587*^9, 3.75602985946216*^9}, {3.7586313087846403`*^9, 
  3.758631311512072*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Field operators", "Subsubsection",
 CellChangeTimes->{{3.561981309203875*^9, 3.561981313462819*^9}, {
   3.7491229721389947`*^9, 3.749122975332737*^9}, 3.749373088062693*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psid", "=", 
   RowBox[{"HC", "[", "psi", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]n", "[", 
    RowBox[{"n_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Nest", "[", 
    RowBox[{"idR", ",", 
     RowBox[{"Nest", "[", 
      RowBox[{"ZL", ",", "psi", ",", 
       RowBox[{"n", "-", "1"}]}], "]"}], ",", 
     RowBox[{"L", "-", "n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]nd", "[", 
    RowBox[{"n_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Nest", "[", 
    RowBox[{"idR", ",", 
     RowBox[{"Nest", "[", 
      RowBox[{"ZL", ",", "psid", ",", 
       RowBox[{"n", "-", "1"}]}], "]"}], ",", 
     RowBox[{"L", "-", "n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]\[Psi]N", "[", 
   RowBox[{"N_", ",", "L_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]nd", "[", 
     RowBox[{
      RowBox[{"2", "N"}], ",", "L"}], "]"}], ".", 
    RowBox[{"\[Psi]n", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "N"}], "-", "1"}], ",", "L"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"\[Psi]nd", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "N"}], "-", "1"}], ",", "L"}], "]"}], ".", 
    RowBox[{"\[Psi]n", "[", 
     RowBox[{
      RowBox[{"2", "N"}], ",", "L"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.561981278875597*^9, 3.561981282267248*^9}, {
   3.561981316752936*^9, 3.5619813443524942`*^9}, 3.5619815193258944`*^9, {
   3.561981610564814*^9, 3.5619816123535013`*^9}, {3.5619817622251787`*^9, 
   3.561981764231254*^9}, {3.561985510311056*^9, 3.561985574995474*^9}, {
   3.5619856655491447`*^9, 3.561985666843007*^9}, {3.561986055266342*^9, 
   3.561986059617262*^9}, {3.5619867219713287`*^9, 3.561986725577725*^9}, {
   3.561986792081629*^9, 3.5619868204581747`*^9}, {3.561986966030575*^9, 
   3.56198701024291*^9}, {3.561987301767706*^9, 3.5619873099043016`*^9}, {
   3.5619877917377567`*^9, 3.5619878173375597`*^9}, {3.561987859425806*^9, 
   3.561987860712188*^9}, {3.561987962355361*^9, 3.561988019577981*^9}, {
   3.561988083503504*^9, 3.561988085896357*^9}, {3.562826424183242*^9, 
   3.562826428107546*^9}, {3.5628264845118113`*^9, 3.5628264856731033`*^9}, {
   3.562826572851734*^9, 3.562826573881782*^9}, {3.675522539237054*^9, 
   3.675522588600729*^9}, {3.675522654769822*^9, 3.675522667774942*^9}, {
   3.675522711618876*^9, 3.675522713966755*^9}, {3.675522788711341*^9, 
   3.6755228153798723`*^9}, 3.6755230071975603`*^9, {3.675523096572844*^9, 
   3.6755230997870827`*^9}, {3.675523245687316*^9, 3.675523293514515*^9}, {
   3.675524649135675*^9, 3.675524654070428*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]n", "[", 
   RowBox[{"2", ",", "4"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7492795529304543`*^9, 3.7492795549784937`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7491231262628345`*^9, 3.749279555128277*^9, 
  3.749366973771885*^9, 3.749375955511362*^9, 3.756029393114295*^9, 
  3.758631546667613*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spatial translation operator", "Subsubsection",
 CellChangeTimes->{{3.74919120918239*^9, 3.749191216101513*^9}}],

Cell["\<\
First define pMatrix (entirely in terms of the fielf operator) as the \
operator that shifts the field operator from one position to another (NOTE it \
only does this when the initial and final positions are not the same):\
\>", "Text",
 CellChangeTimes->{{3.7560322274484863`*^9, 3.756032243033106*^9}, {
  3.756032326567562*^9, 3.7560323471145477`*^9}, {3.756032590141811*^9, 
  3.756032597545775*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kMatrix", "[", 
    RowBox[{"pos1_", ",", "pos2_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]nd", "[", 
      RowBox[{"pos1", ",", "n"}], "]"}], ".", 
     RowBox[{"\[Psi]n", "[", 
      RowBox[{"pos2", ",", "n"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"\[Psi]nd", "[", 
      RowBox[{"pos2", ",", "n"}], "]"}], ".", 
     RowBox[{"\[Psi]n", "[", 
      RowBox[{"pos1", ",", "n"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749209854329289*^9, 3.74920987509052*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pMatrix", "[", 
    RowBox[{"pos1_", ",", "pos2_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", 
     SuperscriptBox["2", "n"], "]"}], "+", 
    RowBox[{"kMatrix", "[", 
     RowBox[{"pos1", ",", "pos2", ",", "n"}], "]"}], "-", 
    RowBox[{
     RowBox[{"kMatrix", "[", 
      RowBox[{"pos1", ",", "pos2", ",", "n"}], "]"}], ".", 
     RowBox[{"kMatrix", "[", 
      RowBox[{"pos1", ",", "pos2", ",", "n"}], "]"}]}], "-", 
    RowBox[{"2", 
     RowBox[{
      RowBox[{"\[Psi]nd", "[", 
       RowBox[{"pos1", ",", "n"}], "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"pos1", ",", "n"}], "]"}], ".", 
      RowBox[{"\[Psi]nd", "[", 
       RowBox[{"pos2", ",", "n"}], "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"pos2", ",", "n"}], "]"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749279723253449*^9, 3.74927972826047*^9}}],

Cell["\<\
Demo pMatrix shifting field operator from position 1 to position 2:\
\>", "Text",
 CellChangeTimes->{{3.756032299729987*^9, 3.756032307001828*^9}, {
  3.756032383454002*^9, 3.7560323874860992`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pMatrix", "[", 
    RowBox[{"1", ",", "2", ",", "4"}], "]"}], ".", 
   RowBox[{"\[Psi]n", "[", 
    RowBox[{"1", ",", "4"}], "]"}], ".", 
   RowBox[{"pMatrix", "[", 
    RowBox[{"1", ",", "2", ",", "4"}], "]"}]}], "==", 
  RowBox[{"\[Psi]n", "[", 
   RowBox[{"2", ",", "4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.756032309392673*^9, 3.756032375240589*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.756032366674055*^9, 3.7560323756657333`*^9}, 
   3.7586254872237177`*^9, 3.758631558020609*^9, 3.762258417525922*^9}]
}, Open  ]],

Cell["\<\
Check all position shifts work (and ignore diagonal where we know it won\
\[CloseCurlyQuote]t work):\
\>", "Text",
 CellChangeTimes->{{3.756032393800116*^9, 3.756032400982409*^9}, {
  3.756032449564736*^9, 3.7560324586932697`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pMatrix", "[", 
       RowBox[{"i", ",", "j", ",", "4"}], "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"i", ",", "4"}], "]"}], ".", 
      RowBox[{"pMatrix", "[", 
       RowBox[{"i", ",", "j", ",", "4"}], "]"}]}], "==", 
     RowBox[{"\[Psi]n", "[", 
      RowBox[{"j", ",", "4"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], "//", "mf"}]], "Input",
 CellChangeTimes->{{3.7560324036395617`*^9, 3.756032444537739*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"False", "True", "True", "True"},
     {"True", "False", "True", "True"},
     {"True", "True", "False", "True"},
     {"True", "True", "True", "False"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7560324403023376`*^9, 3.7560324449796457`*^9}, 
   3.758631558088805*^9, 3.7622584192023773`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pMatrix", "[", 
       RowBox[{"i", ",", "j", ",", "8"}], "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"i", ",", "8"}], "]"}], ".", 
      RowBox[{"pMatrix", "[", 
       RowBox[{"i", ",", "j", ",", "8"}], "]"}]}], "==", 
     RowBox[{"\[Psi]n", "[", 
      RowBox[{"j", ",", "8"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}], "//", "mf"}]], "Input",
 CellChangeTimes->{{3.762258874005471*^9, 3.762258879626836*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"False", "True", "True", "True", "True", "True", "True", "True"},
     {"True", "False", "True", "True", "True", "True", "True", "True"},
     {"True", "True", "False", "True", "True", "True", "True", "True"},
     {"True", "True", "True", "False", "True", "True", "True", "True"},
     {"True", "True", "True", "True", "False", "True", "True", "True"},
     {"True", "True", "True", "True", "True", "False", "True", "True"},
     {"True", "True", "True", "True", "True", "True", "False", "True"},
     {"True", "True", "True", "True", "True", "True", "True", "False"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.762258883292432*^9}]
}, Open  ]],

Cell["\<\
Now use the pMatrix to define the spatial translation oeprator vRHalf:\
\>", "Text",
 CellChangeTimes->{{3.756032471325447*^9, 3.7560324945330353`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"listOfConsecutivePMatrices", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"pMatrix", "[", 
      RowBox[{"i", ",", 
       RowBox[{"i", "+", "1"}], ",", "n"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vRHalf", "[", "n_", "]"}], ":=", 
   RowBox[{"matrixProduct", "[", 
    RowBox[{"listOfConsecutivePMatrices", "[", "n", "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7492800485938597`*^9, 3.749280075947344*^9}}],

Cell["Demo the vRHalf operator:", "Text",
 CellChangeTimes->{{3.756032530214099*^9, 3.756032537581913*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"vRHalf", "[", "4", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.74928008136112*^9, 3.749280089030068*^9}, {
  3.749280165126741*^9, 3.749280166683303*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749280084302718*^9, 3.749280089556531*^9}, 
   3.749280167227442*^9, 3.749366982167493*^9, 3.7493766036562614`*^9, 
   3.7560294019606752`*^9, 3.758631558220245*^9, 3.762258432239266*^9}]
}, Open  ]],

Cell["Demo of vRHalf doing a translation on a state:", "Text",
 CellChangeTimes->{{3.75603096871882*^9, 3.75603098197515*^9}, 
   3.756031079344068*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmpVec", "=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{
     SuperscriptBox["2", "4"], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", "tmpVec", "]"}]}], "Input",
 CellChangeTimes->{{3.7560308155034237`*^9, 3.7560308761654673`*^9}, {
  3.756031127795608*^9, 3.7560311367299623`*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "0", "0", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756030835800231*^9, 3.756030880479108*^9}, {
   3.756031134654303*^9, 3.756031137452142*^9}, 3.758631558287532*^9, 
   3.762258436127042*^9}]
}, Open  ]],

Cell["Translate to the right and print in Ket form:", "Text",
 CellChangeTimes->{{3.756030994369972*^9, 3.756031006870078*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "1"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "2"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "3"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "4"}], "]"}], ".", "tmpVec"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.756031010289756*^9, 3.756031031984294*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "1", "0", "0", "0"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756031018057599*^9, 3.7560310324086237`*^9}, 
   3.7560311406508083`*^9, 3.758631558354261*^9, 3.762258438709844*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "1", "0", "0"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756031018057599*^9, 3.7560310324086237`*^9}, 
   3.7560311406508083`*^9, 3.758631558354261*^9, 3.762258438711192*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "0", "1", "0"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756031018057599*^9, 3.7560310324086237`*^9}, 
   3.7560311406508083`*^9, 3.758631558354261*^9, 3.762258438712188*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "0", "0", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756031018057599*^9, 3.7560310324086237`*^9}, 
   3.7560311406508083`*^9, 3.758631558354261*^9, 3.762258438713128*^9}]
}, Open  ]],

Cell["Translate to the left and print in Ket form:", "Text",
 CellChangeTimes->{{3.756031038186585*^9, 3.7560310486985893`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"HC", "[", 
      RowBox[{"vRHalf", "[", "4", "]"}], "]"}], ",", "1"}], "]"}], ".", 
   "tmpVec"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"HC", "[", 
      RowBox[{"vRHalf", "[", "4", "]"}], "]"}], ",", "2"}], "]"}], ".", 
   "tmpVec"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"HC", "[", 
      RowBox[{"vRHalf", "[", "4", "]"}], "]"}], ",", "3"}], "]"}], ".", 
   "tmpVec"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"HC", "[", 
      RowBox[{"vRHalf", "[", "4", "]"}], "]"}], ",", "4"}], "]"}], ".", 
   "tmpVec"}], "]"}]}], "Input",
 CellChangeTimes->{{3.756030890693935*^9, 3.756030962688539*^9}, {
  3.756031053197357*^9, 3.756031069202003*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "0", "1", "0"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756030897223483*^9, 3.7560309631945887`*^9}, 
   3.756031070125017*^9, 3.756031142110484*^9, 3.758631558420281*^9, 
   3.762258439982459*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "1", "0", "0"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756030897223483*^9, 3.7560309631945887`*^9}, 
   3.756031070125017*^9, 3.756031142110484*^9, 3.758631558420281*^9, 
   3.762258439983672*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "1", "0", "0", "0"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756030897223483*^9, 3.7560309631945887`*^9}, 
   3.756031070125017*^9, 3.756031142110484*^9, 3.758631558420281*^9, 
   3.762258439984624*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "0", "0", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756030897223483*^9, 3.7560309631945887`*^9}, 
   3.756031070125017*^9, 3.756031142110484*^9, 3.758631558420281*^9, 
   3.762258439985635*^9}]
}, Open  ]],

Cell["Some translations come with minus signs:", "Text",
 CellChangeTimes->{{3.756031091185583*^9, 3.7560311052832527`*^9}, {
  3.756031729725806*^9, 3.756031756837236*^9}, {3.756031984535635*^9, 
  3.7560320064002542`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmpVec", "=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{
     SuperscriptBox["2", "4"], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", "tmpVec", "]"}]}], "Input",
 CellChangeTimes->{{3.7560311473869267`*^9, 3.756031161660013*^9}, 
   3.756031712751975*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "0", "1", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756031150038591*^9, 3.756031161873556*^9}, 
   3.756031713646698*^9, 3.75863155848818*^9, 3.762258445273815*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "1"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "2"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "3"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "4"}], "]"}], ".", "tmpVec"}], 
  "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
   TemplateBox[{",", "\",\"", "1", "0", "0", "1"}, "RowWithSeparators"]},
   "Ket"]}]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.758631558554532*^9, 3.762258446232964*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "1", "1", "0", "0"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.758631558554532*^9, 3.762258446235051*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "1", "1", "0"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.758631558554532*^9, 3.7622584462366877`*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "0", "1", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.758631558554532*^9, 3.762258446238303*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmpVec", "=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{
     SuperscriptBox["2", "4"], ",", "6"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", "tmpVec", "]"}]}], "Input",
 CellChangeTimes->{{3.7560311473869267`*^9, 3.756031161660013*^9}, 
   3.756031712751975*^9, 3.7560317844889517`*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "1", "0", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756031150038591*^9, 3.756031161873556*^9}, 
   3.756031713646698*^9, 3.756031785292562*^9, 3.7586315586203012`*^9, 
   3.762258448121759*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "1"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "2"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "3"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "4"}], "]"}], ".", "tmpVec"}], 
  "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
   TemplateBox[{",", "\",\"", "1", "0", "1", "0"}, "RowWithSeparators"]},
   "Ket"]}]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.7560317866759787`*^9, 3.758631558686865*^9, 3.76225844908364*^9}],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
   TemplateBox[{",", "\",\"", "0", "1", "0", "1"}, "RowWithSeparators"]},
   "Ket"]}]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.7560317866759787`*^9, 3.758631558686865*^9, 3.762258449084907*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "1", "0", "1", "0"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.7560317866759787`*^9, 3.758631558686865*^9, 3.762258449085845*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "0", "1", "0", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.7560317866759787`*^9, 3.758631558686865*^9, 3.762258449086917*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmpVec", "=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{
     SuperscriptBox["2", "4"], ",", "10"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", "tmpVec", "]"}]}], "Input",
 CellChangeTimes->{{3.7560311473869267`*^9, 3.756031161660013*^9}, 
   3.756031712751975*^9, {3.7560318533908033`*^9, 3.7560318535121727`*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "1", "0", "0", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756031150038591*^9, 3.756031161873556*^9}, 
   3.756031713646698*^9, 3.7560318603241262`*^9, 3.75863155875408*^9, 
   3.7622584505634737`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "1"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "2"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "3"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "4"}], "]"}], ".", "tmpVec"}], 
  "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
   TemplateBox[{",", "\",\"", "1", "1", "0", "0"}, "RowWithSeparators"]},
   "Ket"]}]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.7560318627227373`*^9, 3.758631558820446*^9, 3.762258451481124*^9}],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
   TemplateBox[{",", "\",\"", "0", "1", "1", "0"}, "RowWithSeparators"]},
   "Ket"]}]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.7560318627227373`*^9, 3.758631558820446*^9, 3.7622584514825077`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
   TemplateBox[{",", "\",\"", "0", "0", "1", "1"}, "RowWithSeparators"]},
   "Ket"]}]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.7560318627227373`*^9, 3.758631558820446*^9, 3.762258451483574*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "1", "0", "0", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.7560318627227373`*^9, 3.758631558820446*^9, 3.762258451484515*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmpVec", "=", 
   RowBox[{"UnitVector", "[", 
    RowBox[{
     SuperscriptBox["2", "4"], ",", "16"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", "tmpVec", "]"}]}], "Input",
 CellChangeTimes->{{3.7560311473869267`*^9, 3.756031161660013*^9}, 
   3.756031712751975*^9, {3.756031857919033*^9, 3.756031858399308*^9}}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "1", "1", "1", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{{3.756031150038591*^9, 3.756031161873556*^9}, 
   3.756031713646698*^9, 3.75603187333393*^9, 3.758631559070648*^9, 
   3.762258452907215*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "1"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "2"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "3"}], "]"}], ".", "tmpVec"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ",", "4"}], "]"}], ".", "tmpVec"}], 
  "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
   TemplateBox[{",", "\",\"", "1", "1", "1", "1"}, "RowWithSeparators"]},
   "Ket"]}]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.756031880329524*^9, 3.758631559137869*^9, 3.7622584540999937`*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "1", "1", "1", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.756031880329524*^9, 3.758631559137869*^9, 3.7622584541014957`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  TemplateBox[{
   TemplateBox[{",", "\",\"", "1", "1", "1", "1"}, "RowWithSeparators"]},
   "Ket"]}]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.756031880329524*^9, 3.758631559137869*^9, 3.7622584541025476`*^9}],

Cell[BoxData[
 TemplateBox[{
  TemplateBox[{",", "\",\"", "1", "1", "1", "1"}, "RowWithSeparators"]},
  "Ket"]], "Output",
 CellChangeTimes->{3.75603117694346*^9, 3.756031715795103*^9, 
  3.756031880329524*^9, 3.758631559137869*^9, 3.762258454103681*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixPower", "[", 
   RowBox[{
    RowBox[{"vRHalf", "[", "4", "]"}], ",", "4"}], "]"}], "//", 
  "mf"}]], "Input",
 CellChangeTimes->{{3.7560439308013773`*^9, 3.75604394254932*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.756043942936961*^9, 3.758631559204438*^9, 
  3.762258455716406*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolution operators (in terms of field operators)", "Subsubsection",
 CellChangeTimes->{{3.749296564698621*^9, 3.749296582908246*^9}, {
  3.756029330146735*^9, 3.7560293314539003`*^9}}],

Cell["\<\
Take b=Sin[\[Theta]]Exp[ i y ], c=-i Cos[\[Theta]]Exp[ i y ]  , w=Exp[ i t ]\
\>", "Text",
 CellChangeTimes->{{3.749373126760373*^9, 3.749373192526785*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"Pi", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", " ", "Pi"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.749374333829673*^9, {3.762258471337224*^9, 3.7622584753282537`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Theta]", "=", 
    RowBox[{"Pi", "/", "4"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"y", "=", " ", 
    RowBox[{"3", 
     RowBox[{"Pi", "/", "4"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"t", "=", " ", 
    RowBox[{"Pi", "/", "2"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7493743200502033`*^9, 3.7493743201438007`*^9}, {
  3.75602941591644*^9, 3.756029454215008*^9}, {3.7622584651151543`*^9, 
  3.762258467641142*^9}}],

Cell["Define R operator from paper (called rMatrix here):", "Text",
 CellChangeTimes->{{3.756032647408442*^9, 3.7560326611368427`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rMatrix", "[", 
    RowBox[{"pos1_", ",", "pos2_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", 
     SuperscriptBox["2", "n"], "]"}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "y"}], "]"}], 
     RowBox[{"kMatrix", "[", 
      RowBox[{"pos1", ",", "pos2", ",", "n"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "I"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "y"}], "]"}]}], "-", "1"}], ")"}], 
     RowBox[{
      RowBox[{"kMatrix", "[", 
       RowBox[{"pos1", ",", "pos2", ",", "n"}], "]"}], ".", 
      RowBox[{"kMatrix", "[", 
       RowBox[{"pos1", ",", "pos2", ",", "n"}], "]"}]}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "t"}], "]"}], "-", "1"}], ")"}], 
     RowBox[{
      RowBox[{"\[Psi]nd", "[", 
       RowBox[{"pos1", ",", "n"}], "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"pos1", ",", "n"}], "]"}], ".", 
      RowBox[{"\[Psi]nd", "[", 
       RowBox[{"pos2", ",", "n"}], "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"pos2", ",", "n"}], "]"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7492966019583*^9, 3.7492967535454903`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"listOfConsecutiveRMatricesStartingAt1", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"rMatrix", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "i"}], "-", "1"}], ",", 
       RowBox[{"2", " ", "i"}], ",", "n"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"listOfConsecutiveRMatricesStartingAt2", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"rMatrix", "[", 
      RowBox[{
       RowBox[{"2", "i"}], ",", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "i"}], "+", "1"}], ",", "n"}], "]"}], ",", "n"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.749366991970613*^9, 3.749367091679657*^9}, {
  3.749367192797469*^9, 3.749367229373515*^9}, {3.749367314552085*^9, 
  3.749367319849846*^9}}],

Cell[TextData[{
 "Define the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "+"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "-"], TraditionalForm]]],
 " operators from paper (called UP and UM here):"
}], "Text",
 CellChangeTimes->{{3.7560327224177*^9, 3.756032747968996*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UP", "[", "n_", "]"}], ":=", 
   RowBox[{"matrixProduct", "[", 
    RowBox[{"listOfConsecutiveRMatricesStartingAt1", "[", "n", "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UM", "[", "n_", "]"}], ":=", 
   RowBox[{"matrixProduct", "[", 
    RowBox[{"listOfConsecutiveRMatricesStartingAt2", "[", "n", "]"}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.7493673493474617`*^9, 3.749367379496667*^9}}],

Cell["Finally, define full evolution operator:", "Text",
 CellChangeTimes->{{3.756032751265746*^9, 3.756032759746613*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"UP", "[", "n", "]"}], ".", 
    RowBox[{"UM", "[", "n", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749367454173129*^9, 3.749367467280079*^9}}],

Cell["Print some example evolution operators", "Text",
 CellChangeTimes->{{3.756031308515954*^9, 3.756031314459711*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"UP", "[", "4", "]"}], "//", "mf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UM", "[", "4", "]"}], "//", "mf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "[", "4", "]"}], "//", "mf"}]}], "Input",
 CellChangeTimes->{{3.749367468848584*^9, 3.749367511560647*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749367470554076*^9, 3.749367478330924*^9}, 
   3.749367512209296*^9, 3.7493743433839273`*^9, 3.749380167655965*^9, 
   3.7560294673295107`*^9, 3.7560353182518387`*^9, 3.7586263873606052`*^9, 
   3.762258485172282*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749367470554076*^9, 3.749367478330924*^9}, 
   3.749367512209296*^9, 3.7493743433839273`*^9, 3.749380167655965*^9, 
   3.7560294673295107`*^9, 3.7560353182518387`*^9, 3.7586263873606052`*^9, 
   3.76225848517402*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749367470554076*^9, 3.749367478330924*^9}, 
   3.749367512209296*^9, 3.7493743433839273`*^9, 3.749380167655965*^9, 
   3.7560294673295107`*^9, 3.7560353182518387`*^9, 3.7586263873606052`*^9, 
   3.76225848517657*^9}]
}, Open  ]],

Cell["\<\
Look at the eigenstates of the evolution operator to find the stationary \
states:\
\>", "Text",
 CellChangeTimes->{{3.756031254964601*^9, 3.756031279491912*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Eigensystem", "[", 
   RowBox[{"U", "[", "4", "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eigensystem", "[", 
   RowBox[{"U", "[", "4", "]"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.74938018194305*^9, 3.74938022046362*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "\[ImaginaryI]", ",", "\[ImaginaryI]", ",", 
   "\[ImaginaryI]", ",", "\[ImaginaryI]", ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", "1", ",", "1", ",", "1", ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.749380193614729*^9, 3.749380220901021*^9}, 
   3.756029477654442*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", 
     ",", 
     RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0",
      ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "2", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0",
      ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1",
      ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", "1", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "1", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.749380193614729*^9, 3.749380220901021*^9}, 
   3.756029477673654*^9}]
}, Open  ]],

Cell["Print an example eigenstate in Ket form:", "Text",
 CellChangeTimes->{{3.756031284046877*^9, 3.756031290066515*^9}, {
  3.756031323437565*^9, 3.7560313247685013`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{
   RowBox[{"Eigensystem", "[", 
    RowBox[{"U", "[", "4", "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "15"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7560299430774403`*^9, 3.756029963435568*^9}, {
  3.756030005660569*^9, 3.75603001480884*^9}, {3.7560300903709917`*^9, 
  3.7560301050291777`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", 
    TemplateBox[{
     TemplateBox[{",", "\",\"", "0", "0", "0", "1"}, "RowWithSeparators"]},
     "Ket"]}], ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "0", "0", "1", "0"}, "RowWithSeparators"]},
    "Ket"], ",", "0", ",", 
   RowBox[{"-", 
    TemplateBox[{
     TemplateBox[{",", "\",\"", "0", "1", "0", "0"}, "RowWithSeparators"]},
     "Ket"]}], ",", "0", ",", "0", ",", "0", ",", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "1", "0", "0", "0"}, "RowWithSeparators"]},
    "Ket"], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.75602995127094*^9, 3.756029964376554*^9}, {
  3.756030005904001*^9, 3.756030015082717*^9}, {3.756030090932665*^9, 
  3.756030105344894*^9}}]
}, Open  ]],

Cell["\<\
Check that the commutators of the evolution operators and the translation \
operators vanish: \
\>", "Text",
 CellChangeTimes->{{3.7560313303034897`*^9, 3.756031353245026*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ".", 
     RowBox[{"vRHalf", "[", "4", "]"}]}], ",", 
    RowBox[{"UP", "[", "4", "]"}]}], "]"}], "//", 
  "mf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"vRHalf", "[", "4", "]"}], ".", 
     RowBox[{"vRHalf", "[", "4", "]"}]}], ",", 
    RowBox[{"UM", "[", "4", "]"}]}], "]"}], "//", "mf"}]}], "Input",
 CellChangeTimes->{{3.749296946549816*^9, 3.749296970900116*^9}, {
  3.749367405186363*^9, 3.749367411465109*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749296954519273*^9, 3.749296971871229*^9}, 
   3.749367412313286*^9, 3.749374347871895*^9, 3.756030128620741*^9, 
   3.7622584925171556`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749296954519273*^9, 3.749296971871229*^9}, 
   3.749367412313286*^9, 3.749374347871895*^9, 3.756030128620741*^9, 
   3.7622584925193567`*^9}]
}, Open  ]],

Cell["Check some more relations from paper:", "Text",
 CellChangeTimes->{{3.7560313593763866`*^9, 3.75603136377635*^9}, {
  3.756032770466811*^9, 3.756032772791361*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"UP", "[", "4", "]"}], "==", 
  RowBox[{
   RowBox[{"vRHalf", "[", "4", "]"}], ".", 
   RowBox[{"UM", "[", "4", "]"}], ".", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"vRHalf", "[", "4", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UM", "[", "4", "]"}], "==", 
  RowBox[{
   RowBox[{"vRHalf", "[", "4", "]"}], ".", 
   RowBox[{"UP", "[", "4", "]"}], ".", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"vRHalf", "[", "4", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.749296989514373*^9, 3.74929703513743*^9}, {
  3.7493674337290382`*^9, 3.749367445305929*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.749297008465578*^9, 3.749297035838353*^9}, 
   3.749367445959201*^9, 3.749374353088841*^9, 3.756030132619775*^9, 
   3.762258495457251*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.749297008465578*^9, 3.749297035838353*^9}, 
   3.749367445959201*^9, 3.749374353088841*^9, 3.756030132619775*^9, 
   3.762258495458064*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"UP", "[", "8", "]"}], "==", 
  RowBox[{
   RowBox[{"vRHalf", "[", "8", "]"}], ".", 
   RowBox[{"UM", "[", "8", "]"}], ".", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"vRHalf", "[", "8", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UM", "[", "8", "]"}], "==", 
  RowBox[{
   RowBox[{"vRHalf", "[", "8", "]"}], ".", 
   RowBox[{"UP", "[", "8", "]"}], ".", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"vRHalf", "[", "8", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.762258503285034*^9, 3.762258515282625*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.7622585167191153`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.762258517172961*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", "4", "]"}], ".", 
   RowBox[{"\[Psi]n", "[", 
    RowBox[{"3", ",", "4"}], "]"}], ".", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"U", "[", "4", "]"}], "]"}]}], "-", 
  RowBox[{"\[Psi]n", "[", 
   RowBox[{"1", ",", "4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.762258540018659*^9, 3.762258615344324*^9}, {
  3.762258693349998*^9, 3.762258702902523*^9}, {3.762510521385022*^9, 
  3.762510531126051*^9}, {3.762510641200646*^9, 3.762510642112235*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.762258567786319*^9, 3.7622586162016582`*^9}, {
  3.762258695550002*^9, 3.762258704042511*^9}, {3.762510522022559*^9, 
  3.762510531539689*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rMatrix", "[", 
     RowBox[{"i", ",", "j", ",", "num"}], "]"}], "\[Equal]", 
    RowBox[{"pMatrix", "[", 
     RowBox[{"i", ",", "j", ",", "num"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "num"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "num"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.762258755374311*^9, 3.762258836066476*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
     ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
     ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
     ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
     ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
     ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
     ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
     ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
     ",", "True", ",", "True"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.762258787374153*^9, {3.762258828590695*^9, 3.762258838815627*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"U", "[", "8", "]"}], ".", 
         RowBox[{"\[Psi]n", "[", 
          RowBox[{"i", ",", "8"}], "]"}], ".", 
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"U", "[", "8", "]"}], "]"}]}], "-", 
        RowBox[{"\[Psi]n", "[", 
         RowBox[{"j", ",", "8"}], "]"}]}], "]"}], ",", "0"}], "]"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.762510539974086*^9, 3.762510545486889*^9}, {
  3.762510587713305*^9, 3.7625105889591913`*^9}, {3.7625106191069508`*^9, 
  3.7625106355427732`*^9}, {3.762510669161949*^9, 3.762510703245985*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "256", ",", "256", ",", "256", ",", "256", ",", "256", ",", "256", ",", 
     "0", ",", "256"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "256", ",", "256", ",", "256", ",", "0", ",", "256", ",", "256", ",", 
     "256", ",", "256"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "256", ",", "256", ",", "256", ",", "256", ",", "256", ",", 
     "256", ",", "256"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "256", ",", "256", ",", "256", ",", "256", ",", "256", ",", "0", ",", 
     "256", ",", "256"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "256", ",", "256", ",", "0", ",", "256", ",", "256", ",", "256", ",", 
     "256", ",", "256"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "256", ",", "256", ",", "256", ",", "256", ",", "256", ",", "256", ",", 
     "256", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "256", ",", "256", ",", "256", ",", "256", ",", "0", ",", "256", ",", 
     "256", ",", "256"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "256", ",", "0", ",", "256", ",", "256", ",", "256", ",", "256", ",", 
     "256", ",", "256"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.762510547318817*^9, 3.762510590651065*^9, 
  3.762510631848948*^9, 3.762510690119605*^9, 3.762510725594481*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lightcone evolution operators", "Subsubsection",
 CellChangeTimes->{{3.749367531830427*^9, 3.749367536252561*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UR", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"UP", "[", "n", "]"}], ".", 
    RowBox[{"vRHalf", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UL", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"UP", "[", "n", "]"}], ".", 
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"vRHalf", "[", "n", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.749367545025194*^9, 3.749367595244725*^9}}],

Cell["Check some relations for the lightcone evolution operators:", "Text",
 CellChangeTimes->{{3.756031376056638*^9, 3.756031384737606*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "[", "4", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"UR", "[", "4", "]"}], ".", 
   RowBox[{"UL", "[", "4", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UR", "[", "4", "]"}], ".", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"UL", "[", "4", "]"}], "]"}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"vRHalf", "[", "4", "]"}], ".", 
   RowBox[{"vRHalf", "[", "4", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.749367603010816*^9, 3.7493676585105953`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.749367610523322*^9, 3.749367659160424*^9, 
  3.749374356446206*^9, 3.758626616594305*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Other definition of evolution operator used in paper (INCORRECT!)\
\>", "Subsubsection",
 CellChangeTimes->{{3.5628266178994837`*^9, 3.562826624294145*^9}, 
   3.7491229820653477`*^9, {3.749367679589538*^9, 3.749367684602108*^9}, {
   3.75602927658505*^9, 3.756029285022416*^9}, {3.756031401926908*^9, 
   3.756031403665444*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"Pi", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", " ", "Pi"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", "y"}], "]"}]}], 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", "y"}], "]"}]}], "0"},
       {"0", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", "y"}], "]"}]}], 
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", "y"}], "]"}]}], "0"},
       {"0", "0", "0", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "t"}], "]"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"R", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0", "0"},
        {"0", "c", "b", "0"},
        {"0", "b", "c", "0"},
        {"0", "0", "0", "w"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"R", "//", "mf"}]}], "Input",
 CellChangeTimes->{{3.6784494166896677`*^9, 3.678449439187744*^9}, {
   3.678449541878587*^9, 3.678449543090996*^9}, 3.678519571484586*^9, {
   3.6785208483246307`*^9, 3.678520848900057*^9}, {3.678531571736877*^9, 
   3.678531573541185*^9}, {3.749120182419325*^9, 3.7491202435724974`*^9}, {
   3.749120406906304*^9, 3.749120407289111*^9}, {3.7491912323935547`*^9, 
   3.74919127074819*^9}, 3.749193110165147*^9, {3.749288365337846*^9, 
   3.749288367801548*^9}, {3.749296832888915*^9, 3.749296836037269*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], 
      FractionBox["1", 
       SqrtBox["2"]], "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.678449537826082*^9, 3.678449546696031*^9}, 
   3.678449729915153*^9, 3.678514555941205*^9, 3.678515319454092*^9, 
   3.6785195722073812`*^9, 3.6785196786623917`*^9, {3.67852084974685*^9, 
   3.678520880071156*^9}, 3.678531539295429*^9, 3.678531573913494*^9, 
   3.749116945139064*^9, {3.7491201877193184`*^9, 3.7491202443183594`*^9}, 
   3.749120407873846*^9, {3.7491912771608953`*^9, 3.749191287468899*^9}, 
   3.749193111863717*^9, 3.749194365400593*^9, 3.749279487784945*^9, 
   3.74928836969632*^9, 3.749296837562769*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rn", "[", "x_", "]"}], ":=", 
  RowBox[{"KroneckerProduct", "[", 
   RowBox[{"R", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UP", "[", "N_", "]"}], ":=", " ", 
  RowBox[{"Nest", "[", 
   RowBox[{"Rn", ",", "R", ",", 
    RowBox[{"N", "-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UM", "[", "N_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"H1", ",", 
          RowBox[{"UP", "[", 
           RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "H1"}], "]"}], "-", 
      RowBox[{"I", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "y"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{"id", ",", 
              RowBox[{"UP", "[", 
               RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "id"}], "]"}], 
          "-", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{"Z", ",", 
              RowBox[{"UP", "[", 
               RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "Z"}], "]"}]}], 
         ")"}], "/", "2"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "y"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{"X", ",", 
              RowBox[{"UP", "[", 
               RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "X"}], "]"}], 
          "+", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{"Y", ",", 
              RowBox[{"UP", "[", 
               RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "Y"}], "]"}]}], 
         ")"}], "/", "2"}]}], "+", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "t"}], "]"}], " ", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"H2", ",", 
           RowBox[{"UP", "[", 
            RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "H2"}], "]"}]}]}], 
     ",", "ass"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", "N_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"UP", "[", "N", "]"}], ".", 
      RowBox[{"UM", "[", "N", "]"}]}], ",", "ass"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5613531284141006`*^9, 3.561353139773589*^9}, {
   3.561353288160838*^9, 3.561353319575922*^9}, {3.5613553840095167`*^9, 
   3.561355454178825*^9}, {3.561356453696241*^9, 3.561356495092766*^9}, {
   3.561366061533978*^9, 3.561366061635191*^9}, {3.5613661006179457`*^9, 
   3.561366114984067*^9}, 3.561366209236568*^9, {3.561366277006181*^9, 
   3.561366290764175*^9}, {3.678434266443343*^9, 3.6784343976241093`*^9}, {
   3.678436656898265*^9, 3.6784366661207314`*^9}, 3.678448664433209*^9, {
   3.678449012843411*^9, 3.6784490533176107`*^9}, {3.67844945568758*^9, 
   3.678449456465685*^9}, {3.749122996145257*^9, 3.7491230126862884`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"KroneckerProduct", "[", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"H1", ",", 
      RowBox[{"UP", "[", 
       RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "H1"}], "]"}], "-", 
  RowBox[{"I", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"I", " ", "y"}], "]"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"id", ",", 
          RowBox[{"UP", "[", 
           RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "id"}], "]"}], "-", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"Z", ",", 
          RowBox[{"UP", "[", 
           RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "Z"}], "]"}]}], 
     ")"}], "/", "2"}]}], "+", 
  RowBox[{
   RowBox[{"Sin", "[", "\[Theta]", "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"I", " ", "y"}], "]"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"X", ",", 
          RowBox[{"UP", "[", 
           RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "X"}], "]"}], "+", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"Y", ",", 
          RowBox[{"UP", "[", 
           RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "Y"}], "]"}]}], 
     ")"}], "/", "2"}]}], "+", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"I", " ", "t"}], "]"}], " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"H2", ",", 
       RowBox[{"UP", "[", 
        RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "H2"}], 
    "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UMtest", "[", "N_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"H1", ",", 
          RowBox[{"UP", "[", 
           RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "H1"}], "]"}], "-", 
      RowBox[{"I", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "y"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"H1", ",", 
             RowBox[{"UP", "[", 
              RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "H2"}], "]"}], 
         "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"H2", ",", 
             RowBox[{"UP", "[", 
              RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "H1"}], "]"}]}], 
        ")"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "y"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"O1", ",", 
             RowBox[{"UP", "[", 
              RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "O2"}], "]"}], 
         "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"O2", ",", 
             RowBox[{"UP", "[", 
              RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "O1"}], "]"}]}], 
        ")"}]}], "+", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "t"}], "]"}], " ", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"H2", ",", 
           RowBox[{"UP", "[", 
            RowBox[{"N", "-", "1"}], "]"}]}], "]"}], ",", "H2"}], "]"}]}]}], 
     ",", "ass"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749282944461788*^9, 3.749282944813918*^9}, {
  3.7492829804355288`*^9, 3.7492830077602386`*^9}, {3.749287221459881*^9, 
  3.7492872497396727`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UMtest", "[", "2", "]"}], "\[Equal]", 
  RowBox[{"UM", "[", "2", "]"}]}]], "Input",
 CellChangeTimes->{{3.749287256185465*^9, 3.749287267504795*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.749287260696733*^9, 3.749287267924103*^9}, 
   3.749288376685987*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UP", "[", "1", "]"}], "//", "mf"}]], "Input",
 CellChangeTimes->{{3.749288183877488*^9, 3.7492881998601723`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "c", "b", "0"},
     {"0", "b", "c", "0"},
     {"0", "0", "0", "w"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749288192663499*^9, 3.749288200181403*^9}, 
   3.749288378385498*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UMtest", "[", "2", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.749288149057291*^9, 3.7492881692377253`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], "0", "0", "0", "0", "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "c", "0", "b", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "c"}], 
        SqrtBox["2"]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "b"}], 
        SqrtBox["2"]]}], "0", "0", "0", "0", 
      FractionBox["c", 
       SqrtBox["2"]], "0", 
      FractionBox["b", 
       SqrtBox["2"]], "0", "0", "0"},
     {"0", "0", "b", "0", "c", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "b"}], 
        SqrtBox["2"]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "c"}], 
        SqrtBox["2"]]}], "0", "0", "0", "0", 
      FractionBox["b", 
       SqrtBox["2"]], "0", 
      FractionBox["c", 
       SqrtBox["2"]], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "w", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "w"}], 
        SqrtBox["2"]]}], "0", "0", "0", "0", "0", "0", 
      FractionBox["w", 
       SqrtBox["2"]], "0"},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["c", 
       SqrtBox["2"]], "0", 
      FractionBox["b", 
       SqrtBox["2"]], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "c"}], 
        SqrtBox["2"]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "b"}], 
        SqrtBox["2"]]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "c"}], "0", 
      RowBox[{"-", "b"}], "0", "0"},
     {"0", "0", "0", 
      FractionBox["b", 
       SqrtBox["2"]], "0", 
      FractionBox["c", 
       SqrtBox["2"]], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "b"}], 
        SqrtBox["2"]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "c"}], 
        SqrtBox["2"]]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "b"}], "0", 
      RowBox[{"-", "c"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      FractionBox["w", 
       SqrtBox["2"]], "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "w"}], 
        SqrtBox["2"]]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "w"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749288149674377*^9, 3.749288169892617*^9}, 
   3.749288379754764*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "[", "2", "]"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixPower", "[", 
   RowBox[{
    RowBox[{"U", "[", "2", "]"}], ",", "4"}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.749117202277362*^9, 3.7491172533884335`*^9}, {
  3.749119183100517*^9, 3.749119188385398*^9}, {3.7491197638817205`*^9, 
  3.7491199048374467`*^9}, {3.7491202676769123`*^9, 3.749120295793049*^9}, {
  3.7491230174726486`*^9, 3.74912303081519*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", 
      FractionBox["1", "2"], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", 
      FractionBox["1", "2"], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", 
      FractionBox["1", "2"], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      FractionBox["1", "2"], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], 
      FractionBox["1", "2"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      FractionBox["1", "2"], "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", 
      FractionBox["1", "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", "0", 
      FractionBox["1", "2"], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749117206766304*^9, 3.74911721182551*^9}, 
   3.749117253895434*^9, 3.7491191926513977`*^9, 3.7491197671851807`*^9, {
   3.749119815974247*^9, 3.7491199062903495`*^9}, {3.749120254573569*^9, 
   3.749120296010909*^9}, 3.74912042750782*^9, 3.749123032618873*^9, 
   3.7491912925208817`*^9, 3.749193114892603*^9, 3.749279490384296*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], 
      FractionBox["1", "2"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", 
      FractionBox["1", "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749117206766304*^9, 3.74911721182551*^9}, 
   3.749117253895434*^9, 3.7491191926513977`*^9, 3.7491197671851807`*^9, {
   3.749119815974247*^9, 3.7491199062903495`*^9}, {3.749120254573569*^9, 
   3.749120296010909*^9}, 3.74912042750782*^9, 3.749123032618873*^9, 
   3.7491912925208817`*^9, 3.749193114892603*^9, 3.749279490404209*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free massless case", "Section",
 CellChangeTimes->{{3.756033888843885*^9, 3.756033908367962*^9}, {
  3.756033996685445*^9, 3.756034013484354*^9}, {3.7560356748233232`*^9, 
  3.756035684317582*^9}}],

Cell[CellGroupData[{

Cell["Define vR and vL operators", "Subsection",
 CellChangeTimes->{{3.756034313075934*^9, 3.756034320460382*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "listOfConsecutivePMatricesWithDoubleSpacingEven", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"pMatrix", "[", 
      RowBox[{"i", ",", 
       RowBox[{"i", "+", "2"}], ",", "n"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{"n", "-", "2"}], ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"listOfConsecutivePMatricesWithDoubleSpacingOdd", "[", "n_", "]"}],
    ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"pMatrix", "[", 
      RowBox[{"i", ",", 
       RowBox[{"i", "+", "2"}], ",", "n"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"n", "-", "3"}], ",", "2"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.756034356114389*^9, 3.756034359455002*^9}, {
   3.756034656704896*^9, 3.756034662778242*^9}, 3.756034763197831*^9, {
   3.756034871349763*^9, 3.756034901023571*^9}, {3.756034941231251*^9, 
   3.756034951996043*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vR", "[", "n_", "]"}], ":=", 
   RowBox[{"matrixProduct", "[", 
    RowBox[{
    "listOfConsecutivePMatricesWithDoubleSpacingEven", "[", "n", "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vL", "[", "n_", "]"}], ":=", 
   RowBox[{"matrixProduct", "[", 
    RowBox[{"listOfConsecutivePMatricesWithDoubleSpacingOdd", "[", "n", "]"}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7492800485938597`*^9, 3.749280075947344*^9}, {
  3.756034711154191*^9, 3.756034722859756*^9}, {3.756034883193698*^9, 
  3.756034894217267*^9}, {3.756034959057127*^9, 3.7560349659355392`*^9}}],

Cell["Check the definitions are correct:", "Text",
 CellChangeTimes->{{3.7560350285895987`*^9, 3.75603504704459*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vR", "[", "8", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"pMatrix", "[", 
    RowBox[{"2", ",", "4", ",", "8"}], "]"}], ".", 
   RowBox[{"pMatrix", "[", 
    RowBox[{"4", ",", "6", ",", "8"}], "]"}], ".", 
   RowBox[{"pMatrix", "[", 
    RowBox[{"6", ",", "8", ",", "8"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vL", "[", "8", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"pMatrix", "[", 
    RowBox[{"1", ",", "3", ",", "8"}], "]"}], ".", 
   RowBox[{"pMatrix", "[", 
    RowBox[{"3", ",", "5", ",", "8"}], "]"}], ".", 
   RowBox[{"pMatrix", "[", 
    RowBox[{"5", ",", "7", ",", "8"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.756034718721683*^9, 3.75603477083735*^9}, {
  3.7560348180572023`*^9, 3.756034844573245*^9}, {3.756034973320282*^9, 
  3.756035008721397*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7560347273872023`*^9, 3.756034771025546*^9}, {
   3.756034818754664*^9, 3.756034845289372*^9}, 3.756034888570363*^9, {
   3.7560349938854437`*^9, 3.756035009578651*^9}, 3.756035362190185*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7560347273872023`*^9, 3.756034771025546*^9}, {
   3.756034818754664*^9, 3.756034845289372*^9}, 3.756034888570363*^9, {
   3.7560349938854437`*^9, 3.756035009578651*^9}, 3.756035362321939*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vR", "[", "6", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"pMatrix", "[", 
    RowBox[{"2", ",", "4", ",", "6"}], "]"}], ".", 
   RowBox[{"pMatrix", "[", 
    RowBox[{"4", ",", "6", ",", "6"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vL", "[", "6", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"pMatrix", "[", 
    RowBox[{"1", ",", "3", ",", "6"}], "]"}], ".", 
   RowBox[{"pMatrix", "[", 
    RowBox[{"3", ",", "5", ",", "6"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.75603513114004*^9, 3.756035145654361*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.756035146390339*^9, 3.7560353632048492`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.756035146390339*^9, 3.75603536320618*^9}]
}, Open  ]],

Cell["Check they commute with each other:", "Text",
 CellChangeTimes->{{3.7560350519163923`*^9, 3.7560350581488953`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{
    RowBox[{"vR", "[", "6", "]"}], ",", 
    RowBox[{"vL", "[", "6", "]"}]}], "]"}], "\[Equal]", 
  RowBox[{"Table", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      SuperscriptBox["2", "6"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      SuperscriptBox["2", "6"]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.756035060480891*^9, 3.7560351100043907`*^9}, {
  3.756035156338873*^9, 3.756035174877692*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.756035072751357*^9, 3.756035078370034*^9}, 
   3.7560351759159822`*^9, 3.756035365046833*^9}]
}, Open  ]],

Cell["\<\
Check if they commute with the odd or even field operators as they are \
supposed to:\
\>", "Text",
 CellChangeTimes->{{3.756035725197402*^9, 3.756035743030737*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{
    RowBox[{"vR", "[", "6", "]"}], ",", 
    RowBox[{"\[Psi]n", "[", 
     RowBox[{"1", ",", "6"}], "]"}]}], "]"}], "\[Equal]", 
  RowBox[{"Table", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      SuperscriptBox["2", "6"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      SuperscriptBox["2", "6"]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{
    RowBox[{"vR", "[", "6", "]"}], ",", 
    RowBox[{"\[Psi]n", "[", 
     RowBox[{"2", ",", "6"}], "]"}]}], "]"}], "\[Equal]", 
  RowBox[{"Table", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      SuperscriptBox["2", "6"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      SuperscriptBox["2", "6"]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{
    RowBox[{"vL", "[", "6", "]"}], ",", 
    RowBox[{"\[Psi]n", "[", 
     RowBox[{"1", ",", "6"}], "]"}]}], "]"}], "\[Equal]", 
  RowBox[{"Table", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      SuperscriptBox["2", "6"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      SuperscriptBox["2", "6"]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{
    RowBox[{"vL", "[", "6", "]"}], ",", 
    RowBox[{"\[Psi]n", "[", 
     RowBox[{"2", ",", "6"}], "]"}]}], "]"}], "\[Equal]", 
  RowBox[{"Table", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      SuperscriptBox["2", "6"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      SuperscriptBox["2", "6"]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.756035770748467*^9, 3.756035809755631*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.756035773262479*^9, 3.75603581193758*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.756035773262479*^9, 3.7560358119388847`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.756035773262479*^9, 3.7560358119400787`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.756035773262479*^9, 3.7560358119409723`*^9}}]
}, Open  ]],

Cell["\<\
Check what value the parameters b, c, and \[Theta] should be in order to get \
an evolution matrix U that gives the same evolution as vR.vL:\
\>", "Text",
 CellChangeTimes->{{3.7560355858624067`*^9, 3.756035618295335*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"U", "[", "4", "]"}], "\[Equal]", 
     RowBox[{
      RowBox[{"vR", "[", "4", "]"}], ".", 
      RowBox[{"HC", "[", 
       RowBox[{"vL", "[", "4", "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "\[Theta]", ",", "t"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.756035331348652*^9, 3.7560353926869717`*^9}, {
  3.756051576100172*^9, 3.756051578652906*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Pi]", "2"]}], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "3", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"t", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         FractionBox["\[Pi]", "2"], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "3", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"t", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], 
       "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.756035332970263*^9, 3.7560353932156963`*^9}, 
   3.756051580613407*^9}]
}, Open  ]],

Cell["Recall that", "Text",
 CellChangeTimes->{{3.756035624543351*^9, 3.75603562560384*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]", "]"}], 
    RowBox[{"Exp", "[", " ", 
     RowBox[{"i", " ", "y"}], " ", "]"}]}]}], ",", " ", 
  RowBox[{"c", "=", 
   RowBox[{
    RowBox[{"-", "i"}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], 
    RowBox[{"Exp", "[", " ", 
     RowBox[{"i", " ", "y"}], " ", "]"}]}]}], "  ", ",", " ", 
  RowBox[{"w", "=", 
   RowBox[{"Exp", "[", " ", 
    RowBox[{"i", " ", "t"}], " ", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.756035416594821*^9, 3.756035416595264*^9}}],

Cell["Check with first solution:", "Text",
 CellChangeTimes->{{3.756035631223158*^9, 3.756035635639234*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]", "]"}], 
    RowBox[{"Exp", "[", " ", 
     RowBox[{"i", " ", "y"}], " ", "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Pi]", "2"]}], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "3", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"t", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], 
       "]"}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "i"}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], 
    RowBox[{"Exp", "[", " ", 
     RowBox[{"i", " ", "y"}], " ", "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Pi]", "2"]}], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "3", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"t", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], 
       "]"}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Exp", "[", " ", 
    RowBox[{"i", " ", "t"}], " ", "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Pi]", "2"]}], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "3", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"t", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], 
       "]"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7560354365127087`*^9, 3.756035490238641*^9}, {
  3.756051596803392*^9, 3.7560516025941153`*^9}}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"i", " ", "\[Pi]", " ", 
      RowBox[{"C", "[", "2", "]"}]}]]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}], "&&", 
    RowBox[{
     RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.756035451210805*^9, 3.7560354910146112`*^9}, 
   3.756051603199451*^9}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}], "&&", 
    RowBox[{
     RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.756035451210805*^9, 3.7560354910146112`*^9}, 
   3.756051603201469*^9}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"i", " ", 
     RowBox[{"(", 
      RowBox[{"\[Pi]", "+", 
       RowBox[{"2", " ", "\[Pi]", " ", 
        RowBox[{"C", "[", "1", "]"}]}]}], ")"}]}]], ",", 
   RowBox[{
    RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.756035451210805*^9, 3.7560354910146112`*^9}, 
   3.756051603202969*^9}]
}, Open  ]],

Cell["Check with second solution:", "Text",
 CellChangeTimes->{{3.756035638607925*^9, 3.7560356441172943`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]", "]"}], 
    RowBox[{"Exp", "[", " ", 
     RowBox[{"i", " ", "y"}], " ", "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         FractionBox["\[Pi]", "2"], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "3", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"t", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], 
       "]"}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "i"}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], 
    RowBox[{"Exp", "[", " ", 
     RowBox[{"i", " ", "y"}], " ", "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         FractionBox["\[Pi]", "2"], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "3", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"t", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], 
       "]"}]}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Exp", "[", " ", 
    RowBox[{"i", " ", "t"}], " ", "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", " ", 
         RowBox[{"C", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{
         FractionBox["\[Pi]", "2"], "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "3", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
     ",", 
     RowBox[{"t", "\[Rule]", 
      RowBox[{"ConditionalExpression", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "+", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], 
       "]"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7560355178857937`*^9, 3.7560355241002617`*^9}, {
  3.756051611449313*^9, 3.7560516172727633`*^9}}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"i", " ", "\[Pi]", " ", 
     RowBox[{"C", "[", "2", "]"}]}]], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}], "&&", 
    RowBox[{
     RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.756035524912546*^9, 3.756051618364224*^9}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"C", "[", "2", "]"}], "\[Element]", "Integers"}], "&&", 
    RowBox[{
     RowBox[{"C", "[", "3", "]"}], "\[Element]", "Integers"}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.756035524912546*^9, 3.7560516183655357`*^9}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"i", " ", 
     RowBox[{"(", 
      RowBox[{"\[Pi]", "+", 
       RowBox[{"2", " ", "\[Pi]", " ", 
        RowBox[{"C", "[", "1", "]"}]}]}], ")"}]}]], ",", 
   RowBox[{
    RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.756035524912546*^9, 3.756051618366599*^9}]
}, Open  ]],

Cell["\<\
In summary: b=+1,-1 , c=0, and w=-1  for the system to be massless and free.\
\>", "Text",
 CellChangeTimes->{{3.756035648263049*^9, 3.756035671262638*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Find operators that diagonalise the lattice \[OpenCurlyDoubleQuote]equations \
of motion\[CloseCurlyDoubleQuote]\
\>", "Subsection",
 CellChangeTimes->{{3.756035852920301*^9, 3.7560358823533087`*^9}}],

Cell["Lattice equations of motion are", "Text",
 CellChangeTimes->{{3.756035891344206*^9, 3.756035905669574*^9}, {
  3.756036271371738*^9, 3.756036279139189*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vR", "[", "n", "]"}], ".", 
   RowBox[{"\[Psi]n", "[", 
    RowBox[{"k", ",", "n"}], "]"}], ".", 
   RowBox[{"HC", "[", 
    RowBox[{"vR", "[", "n", "]"}], "]"}]}], "=", 
  RowBox[{
   RowBox[{"\[Psi]n", "[", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"k", "+", "2"}], ",", "n", ",", "1"}], "]"}], ",", "n"}], 
    "]"}], "                       ", "for", " ", "k", " ", 
   "even"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vR", "[", "n", "]"}], ".", 
    RowBox[{"\[Psi]n", "[", 
     RowBox[{"k", ",", "n"}], "]"}], ".", 
    RowBox[{"HC", "[", 
     RowBox[{"vR", "[", "n", "]"}], "]"}]}], "=", 
   RowBox[{
    RowBox[{"\[Psi]n", "[", 
     RowBox[{"k", ",", "n"}], "]"}], "                                                     ",
     "for", " ", "k", " ", "odd"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HC", "[", 
    RowBox[{"vL", "[", "n", "]"}], "]"}], ".", 
   RowBox[{"\[Psi]n", "[", 
    RowBox[{"k", ",", "n"}], "]"}], ".", 
   RowBox[{"vL", "[", "n", "]"}]}], "=", 
  RowBox[{
   RowBox[{"\[Psi]n", "[", 
    RowBox[{"k", ",", "n"}], "]"}], "                                                    ",
    "for", " ", "k", " ", "even"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HC", "[", 
    RowBox[{"vL", "[", "n", "]"}], "]"}], ".", 
   RowBox[{"\[Psi]n", "[", 
    RowBox[{"k", ",", "n"}], "]"}], ".", 
   RowBox[{"vL", "[", "n", "]"}]}], "=", 
  RowBox[{
   RowBox[{"\[Psi]n", "[", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"k", "-", "2"}], ",", "n", ",", "1"}], "]"}], ",", "n"}], 
    "]"}], "                      ", "for", " ", "k", " ", 
   "odd"}]}]}], "Input",
 CellChangeTimes->{{3.756035908605316*^9, 3.756036073185418*^9}, {
  3.756036149695279*^9, 3.756036164188525*^9}, {3.756036199024234*^9, 
  3.756036242152796*^9}}],

Cell["Check these are satisfied for some examples:", "Text",
 CellChangeTimes->{{3.756036283339312*^9, 3.7560362886915483`*^9}, {
  3.756036407977173*^9, 3.756036411810463*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vR", "[", "6", "]"}], ".", 
   RowBox[{"\[Psi]n", "[", 
    RowBox[{"2", ",", "6"}], "]"}], ".", 
   RowBox[{"HC", "[", 
    RowBox[{"vR", "[", "6", "]"}], "]"}]}], "\[Equal]", 
  RowBox[{"\[Psi]n", "[", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"2", "+", "2"}], ",", "6", ",", "1"}], "]"}], ",", "6"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vR", "[", "6", "]"}], ".", 
    RowBox[{"\[Psi]n", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ".", 
    RowBox[{"HC", "[", 
     RowBox[{"vR", "[", "6", "]"}], "]"}]}], "\[Equal]", 
   RowBox[{"\[Psi]n", "[", 
    RowBox[{"1", ",", "6"}], "]"}]}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HC", "[", 
     RowBox[{"vL", "[", "6", "]"}], "]"}], ".", 
    RowBox[{"\[Psi]n", "[", 
     RowBox[{"4", ",", "6"}], "]"}], ".", 
    RowBox[{"vL", "[", "6", "]"}]}], "\[Equal]", 
   RowBox[{"\[Psi]n", "[", 
    RowBox[{"4", ",", "6"}], "]"}]}], 
  "                              "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HC", "[", 
    RowBox[{"vL", "[", "6", "]"}], "]"}], ".", 
   RowBox[{"\[Psi]n", "[", 
    RowBox[{"3", ",", "6"}], "]"}], ".", 
   RowBox[{"vL", "[", "6", "]"}]}], "\[Equal]", 
  RowBox[{"\[Psi]n", "[", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"3", "-", "2"}], ",", "6", ",", "1"}], "]"}], ",", "6"}], "]"}],
   "       "}]}], "Input",
 CellChangeTimes->{{3.7560363005188932`*^9, 3.7560364034116697`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7560363255287333`*^9, 3.7560363639180107`*^9}, {
  3.7560363971440573`*^9, 3.756036404632218*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7560363255287333`*^9, 3.7560363639180107`*^9}, {
  3.7560363971440573`*^9, 3.7560364046336946`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7560363255287333`*^9, 3.7560363639180107`*^9}, {
  3.7560363971440573`*^9, 3.756036404634507*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7560363255287333`*^9, 3.7560363639180107`*^9}, {
  3.7560363971440573`*^9, 3.756036404635284*^9}}]
}, Open  ]],

Cell["Check every example:", "Text",
 CellChangeTimes->{{3.7560495775156803`*^9, 3.756049582714941*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"vR", "[", "6", "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"i", ",", "6"}], "]"}], ".", 
      RowBox[{"HC", "[", 
       RowBox[{"vR", "[", "6", "]"}], "]"}]}], "\[Equal]", 
     RowBox[{"\[Psi]n", "[", 
      RowBox[{"j", ",", "6"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "6", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "2", ",", "6", ",", "2"}], "}"}]}], "]"}], "//", 
  "mf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"vR", "[", "6", "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"i", ",", "6"}], "]"}], ".", 
      RowBox[{"HC", "[", 
       RowBox[{"vR", "[", "6", "]"}], "]"}]}], "\[Equal]", 
     RowBox[{"\[Psi]n", "[", 
      RowBox[{"j", ",", "6"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "6", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "6", ",", "2"}], "}"}]}], "]"}], "//", 
  "mf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"HC", "[", 
       RowBox[{"vL", "[", "6", "]"}], "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"i", ",", "6"}], "]"}], ".", 
      RowBox[{"vL", "[", "6", "]"}]}], "\[Equal]", 
     RowBox[{"\[Psi]n", "[", 
      RowBox[{"j", ",", "6"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "6", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "2", ",", "6", ",", "2"}], "}"}]}], "]"}], "//", 
  "mf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"HC", "[", 
       RowBox[{"vL", "[", "6", "]"}], "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"i", ",", "6"}], "]"}], ".", 
      RowBox[{"vL", "[", "6", "]"}]}], "\[Equal]", 
     RowBox[{"\[Psi]n", "[", 
      RowBox[{"j", ",", "6"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "6", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "6", ",", "2"}], "}"}]}], "]"}], "//", 
  "mf"}]}], "Input",
 CellChangeTimes->{{3.7560493372066603`*^9, 3.756049465451873*^9}, {
  3.75604952130344*^9, 3.756049536249714*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"False", "True", "False"},
     {"False", "False", "True"},
     {"True", "False", "False"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.756049398657495*^9, 3.756049430387006*^9}, 
   3.7560495384804583`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"True", "False", "False"},
     {"False", "True", "False"},
     {"False", "False", "True"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.756049398657495*^9, 3.756049430387006*^9}, 
   3.756049538482655*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"True", "False", "False"},
     {"False", "True", "False"},
     {"False", "False", "True"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.756049398657495*^9, 3.756049430387006*^9}, 
   3.756049538544981*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"False", "False", "True"},
     {"True", "False", "False"},
     {"False", "True", "False"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.756049398657495*^9, 3.756049430387006*^9}, 
   3.7560495386082907`*^9}]
}, Open  ]],

Cell[TextData[{
 "We want to find a set of operators ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "k"], TraditionalForm]]],
 " (k labels the different operators in the set, and will be something like \
the momentum), that are linear combinations of the field operators at \
different points, such that they diagonalise the above equations of motion. \
E.g."
}], "Text",
 CellChangeTimes->{{3.756036437846661*^9, 3.7560365634362307`*^9}, {
  3.756036640144643*^9, 3.756036655563064*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vR", "[", "n", "]"}], ".", 
   RowBox[{"bk", "[", "n", "]"}], ".", 
   RowBox[{"HC", "[", 
    RowBox[{"vR", "[", "n", "]"}], "]"}]}], "=", 
  RowBox[{
   SubscriptBox["\[Lambda]", "k"], 
   RowBox[{"bk", "[", "n", "]"}], " "}]}]], "Input",
 CellChangeTimes->{{3.75603657054224*^9, 3.756036607202959*^9}}],

Cell["and similarly for the other equations of motion.", "Text",
 CellChangeTimes->{{3.7560366112063103`*^9, 3.756036621743217*^9}}],

Cell["Use the following ansatz:", "Text",
 CellChangeTimes->{{3.756036697018949*^9, 3.756036702212208*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{"i", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"8", "-", "1"}], ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.756036751375085*^9, 3.756036759929809*^9}, {
  3.756037053706848*^9, 3.7560370574273*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3", ",", "5", ",", "7"}], "}"}]], "Output",
 CellChangeTimes->{{3.7560367564511137`*^9, 3.756036772996961*^9}, 
   3.756037058025523*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"i", "+", "1"}]]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.756049978793722*^9, 3.756050006879105*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.756049994305655*^9, 3.756050007559225*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bR", "[", 
    RowBox[{"k_", ",", "n_", ",", "latticeSpacing_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"i", "+", "1"}]]}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "k", "*", 
        FractionBox["i", "2"], "*", "latticeSpacing"}], "]"}], "*", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"i", ",", "n"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bL", "[", 
    RowBox[{"k_", ",", "n_", ",", "latticeSpacing_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "i"]}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "k", "*", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{"i", "+", "1"}], "2"], ")"}], "*", "latticeSpacing"}], 
       "]"}], "*", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"i", ",", "n"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.756036704567082*^9, 3.756036744617464*^9}, {
  3.756036789694315*^9, 3.756036816962426*^9}, {3.7560368587660723`*^9, 
  3.756036883740417*^9}, {3.756037008368408*^9, 3.756037035368973*^9}, {
  3.756037074237256*^9, 3.756037094074404*^9}, {3.756049933874874*^9, 
  3.75604997358426*^9}, {3.756050017399461*^9, 3.756050060152741*^9}, {
  3.7560501141384068`*^9, 3.756050124901863*^9}}],

Cell["Print some example matrices:", "Text",
 CellChangeTimes->{{3.7560377857598057`*^9, 3.756037793207973*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bR", "[", 
   RowBox[{"k", ",", "4", ",", "a"}], "]"}], "//", 
  "mf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bL", "[", 
   RowBox[{"k", ",", "4", ",", "a"}], "]"}], "//", "mf"}]}], "Input",
 CellChangeTimes->{{3.756037106619871*^9, 3.756037120366302*^9}, {
  3.756037727909123*^9, 3.756037737411517*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.75603711668603*^9, 3.756037120650567*^9}, {
   3.756037733326956*^9, 3.756037738009667*^9}, 3.756050157695632*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.75603711668603*^9, 3.756037120650567*^9}, {
   3.756037733326956*^9, 3.756037738009667*^9}, 3.7560501577001667`*^9}]
}, Open  ]],

Cell["\<\
Print out LHS\[CloseCurlyQuote]s of equations of motion with bR and bL \
substituted in:\
\>", "Text",
 CellChangeTimes->{{3.7560379550997*^9, 3.756037976482853*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vR", "[", "4", "]"}], ".", 
   RowBox[{"bR", "[", 
    RowBox[{"k", ",", "4", ",", "a"}], "]"}], ".", 
   RowBox[{"HC", "[", 
    RowBox[{"vR", "[", "4", "]"}], "]"}]}], "//", 
  "mf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vR", "[", "4", "]"}], ".", 
   RowBox[{"bL", "[", 
    RowBox[{"k", ",", "4", ",", "a"}], "]"}], ".", 
   RowBox[{"HC", "[", 
    RowBox[{"vR", "[", "4", "]"}], "]"}]}], "//", 
  "mf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HC", "[", 
    RowBox[{"vL", "[", "4", "]"}], "]"}], ".", 
   RowBox[{"bR", "[", 
    RowBox[{"k", ",", "4", ",", "a"}], "]"}], ".", 
   RowBox[{"vL", "[", "4", "]"}]}], "//", "mf"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HC", "[", 
    RowBox[{"vL", "[", "4", "]"}], "]"}], ".", 
   RowBox[{"bL", "[", 
    RowBox[{"k", ",", "4", ",", "a"}], "]"}], ".", 
   RowBox[{"vL", "[", "4", "]"}]}], "//", "mf"}]}], "Input",
 CellChangeTimes->{{3.756037834851894*^9, 3.7560379416819763`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.756037867000781*^9, 3.75603789933082*^9}, 
   3.756037942918109*^9, 3.7560501656562767`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.756037867000781*^9, 3.75603789933082*^9}, 
   3.756037942918109*^9, 3.756050165658533*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.756037867000781*^9, 3.75603789933082*^9}, 
   3.756037942918109*^9, 3.756050165660536*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.756037867000781*^9, 3.75603789933082*^9}, 
   3.756037942918109*^9, 3.7560501656624823`*^9}]
}, Open  ]],

Cell["\<\
Two of the LHS\[CloseCurlyQuote]s already give solutions to eigenequations \
with eigenvalue 1, for any value of k:\
\>", "Text",
 CellChangeTimes->{{3.7560381695193777`*^9, 3.75603822928726*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vR", "[", "4", "]"}], ".", 
   RowBox[{"bL", "[", 
    RowBox[{"k", ",", "4", ",", "a"}], "]"}], ".", 
   RowBox[{"HC", "[", 
    RowBox[{"vR", "[", "4", "]"}], "]"}]}], "\[Equal]", 
  RowBox[{"bL", "[", 
   RowBox[{"k", ",", "4", ",", "a"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HC", "[", 
    RowBox[{"vL", "[", "4", "]"}], "]"}], ".", 
   RowBox[{"bR", "[", 
    RowBox[{"k", ",", "4", ",", "a"}], "]"}], ".", 
   RowBox[{"vL", "[", "4", "]"}]}], "\[Equal]", 
  RowBox[{"bR", "[", 
   RowBox[{"k", ",", "4", ",", "a"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.756038139441843*^9, 3.756038164043975*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.756038144295553*^9, 3.756038164465186*^9}, 
   3.7560501739691277`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.756038144295553*^9, 3.756038164465186*^9}, 
   3.756050173970422*^9}]
}, Open  ]],

Cell["Look at first LHS:", "Text",
 CellChangeTimes->{{3.7560383068177023`*^9, 3.756038310825115*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vR", "[", "4", "]"}], ".", 
    RowBox[{"bR", "[", 
     RowBox[{"k", ",", "4", ",", "a"}], "]"}], ".", 
    RowBox[{"HC", "[", 
     RowBox[{"vR", "[", "4", "]"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "k", "*", "a"}], "]"}], ")"}], "*", 
    RowBox[{"bR", "[", 
     RowBox[{"k", ",", "4", ",", "a"}], "]"}]}]}], "//", "mf"}]], "Input",
 CellChangeTimes->{{3.7560380115673018`*^9, 3.7560380640508947`*^9}, {
   3.756038096109091*^9, 3.756038107900894*^9}, {3.756038267766369*^9, 
   3.756038283199592*^9}, 3.756038317808651*^9, {3.756049597296277*^9, 
   3.756049597673283*^9}, {3.756049713361719*^9, 3.756049718984342*^9}, {
   3.7560501824205008`*^9, 3.756050188539187*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "k"}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.756038058157053*^9, 3.756038064652419*^9}, {
   3.756038097573595*^9, 3.756038108479663*^9}, 3.756038284240094*^9, 
   3.7560496017046947`*^9, 3.756049721427247*^9, {3.756050178665197*^9, 
   3.756050189359234*^9}}]
}, Open  ]],

Cell[TextData[{
 "This needs to be the zero matrix in order for the eigenequation to be \
satisfied, and therefore k must satisfy ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", "\[ImaginaryI]", " ", "a", " ", "k"}]]}]], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False,
  CellChangeTimes->{{3.756038058157053*^9, 3.756038064652419*^9}, {
    3.756038097573595*^9, 3.756038108479663*^9}, 3.756038284242106*^9}],
 " = 0. Solve for possible k:"
}], "Text",
 CellChangeTimes->{{3.756038324458281*^9, 3.75603839004377*^9}, {
  3.7562974144212723`*^9, 3.756297417420418*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"I", " ", "2", "*", "k", "*", "a"}], "]"}], "\[Equal]", "1"}], 
   ",", "k"}], "]"}]], "Input",
 CellChangeTimes->{{3.756038391064989*^9, 3.756038408836483*^9}, 
   3.756050209531938*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"k", "\[Rule]", 
    RowBox[{"ConditionalExpression", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Pi]", " ", 
        RowBox[{"C", "[", "1", "]"}]}], "a"], ",", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}]}], "]"}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{3.756038409403173*^9, 3.75605020985964*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SULU example 1", "Section",
 CellChangeTimes->{{3.75863001887582*^9, 3.7586300236233263`*^9}}],

Cell[CellGroupData[{

Cell["Initial kicked state", "Subsubsection",
 CellChangeTimes->{{3.5629522618111677`*^9, 3.562952270020582*^9}, {
  3.675524866596017*^9, 3.675524867134446*^9}, {3.758630056433696*^9, 
  3.758630085255802*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k0", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SO2", "[", "s_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "s", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "s", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "s", "]"}], ",", 
       RowBox[{"Cos", "[", "s", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"purestate", "[", "s_", "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SO2", "[", "s", "]"}], ".", "k0"}], ",", "k0", ",", "k0", ",", 
     "k0", ",", "k0", ",", "k0", ",", "k0", ",", "k0"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]kick", "[", "s_", "]"}], ":=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"purestate", "[", "s", "]"}], ",", 
     RowBox[{"Conjugate", "[", 
      RowBox[{"purestate", "[", "s", "]"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.758630408365987*^9, 3.758630432900071*^9}, {
   3.758630644109786*^9, 3.758630674050045*^9}, {3.758630738697888*^9, 
   3.758630766908936*^9}, {3.7586308503508053`*^9, 3.758630941962873*^9}, 
   3.7586311152074327`*^9, {3.758631355918395*^9, 3.758631466349148*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vectorToBasisKets", "[", 
  RowBox[{"purestate", "[", "s", "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.758631034189143*^9, {3.758631275934184*^9, 3.758631284339315*^9}, {
   3.758631323221116*^9, 3.758631324710412*^9}, {3.758631493717709*^9, 
   3.758631497012637*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   TemplateBox[{
    TemplateBox[{",", "\",\"", "0", "0", "0", "0", "0", "0", "0", "0"}, 
      "RowWithSeparators"]},
    "Ket"]}], "+", 
  RowBox[{
   TemplateBox[{
    TemplateBox[{",", "\",\"", "1", "0", "0", "0", "0", "0", "0", "0"}, 
      "RowWithSeparators"]},
    "Ket"], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}]}]], "Output",
 CellChangeTimes->{3.7586310379114933`*^9, 3.758631217620501*^9, 
  3.7586312858112497`*^9, 3.758631325458356*^9, 3.7586314983548527`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolution operator", "Subsubsection",
 CellChangeTimes->{{3.5628322122242327`*^9, 3.5628322183416348`*^9}}],

Cell["\<\
Take b=Sin[\[Theta]]Exp[ i y ], c=-i Cos[\[Theta]]Exp[ i y ]  , w=Exp[ i t ]\
\>", "Text",
 CellChangeTimes->{{3.749373126760373*^9, 3.749373192526785*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Theta]", "=", 
    RowBox[{"Pi", "/", "4"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"y", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
   RowBox[{"t", "=", " ", "Pi"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{3.749374333829673*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"Pi", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", " ", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7493743200502033`*^9, 3.7493743201438007`*^9}, {
  3.75602941591644*^9, 3.756029454215008*^9}, {3.758633201222454*^9, 
  3.758633215934949*^9}}],

Cell["Define R operator from paper (called rMatrix here):", "Text",
 CellChangeTimes->{{3.756032647408442*^9, 3.7560326611368427`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rMatrix", "[", 
    RowBox[{"pos1_", ",", "pos2_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", 
     SuperscriptBox["2", "n"], "]"}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "y"}], "]"}], 
     RowBox[{"kMatrix", "[", 
      RowBox[{"pos1", ",", "pos2", ",", "n"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "I"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "y"}], "]"}]}], "-", "1"}], ")"}], 
     RowBox[{
      RowBox[{"kMatrix", "[", 
       RowBox[{"pos1", ",", "pos2", ",", "n"}], "]"}], ".", 
      RowBox[{"kMatrix", "[", 
       RowBox[{"pos1", ",", "pos2", ",", "n"}], "]"}]}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "t"}], "]"}], "-", "1"}], ")"}], 
     RowBox[{
      RowBox[{"\[Psi]nd", "[", 
       RowBox[{"pos1", ",", "n"}], "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"pos1", ",", "n"}], "]"}], ".", 
      RowBox[{"\[Psi]nd", "[", 
       RowBox[{"pos2", ",", "n"}], "]"}], ".", 
      RowBox[{"\[Psi]n", "[", 
       RowBox[{"pos2", ",", "n"}], "]"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7492966019583*^9, 3.7492967535454903`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"listOfConsecutiveRMatricesStartingAt1", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"rMatrix", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "i"}], "-", "1"}], ",", 
       RowBox[{"2", " ", "i"}], ",", "n"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"listOfConsecutiveRMatricesStartingAt2", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"rMatrix", "[", 
      RowBox[{
       RowBox[{"2", "i"}], ",", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "i"}], "+", "1"}], ",", "n"}], "]"}], ",", "n"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.749366991970613*^9, 3.749367091679657*^9}, {
  3.749367192797469*^9, 3.749367229373515*^9}, {3.749367314552085*^9, 
  3.749367319849846*^9}}],

Cell[TextData[{
 "Define the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "+"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "-"], TraditionalForm]]],
 " operators from paper (called UP and UM here):"
}], "Text",
 CellChangeTimes->{{3.7560327224177*^9, 3.756032747968996*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UP", "[", "n_", "]"}], ":=", 
   RowBox[{"matrixProduct", "[", 
    RowBox[{"listOfConsecutiveRMatricesStartingAt1", "[", "n", "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UM", "[", "n_", "]"}], ":=", 
   RowBox[{"matrixProduct", "[", 
    RowBox[{"listOfConsecutiveRMatricesStartingAt2", "[", "n", "]"}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.7493673493474617`*^9, 3.749367379496667*^9}}],

Cell["Finally, define full evolution operator:", "Text",
 CellChangeTimes->{{3.756032751265746*^9, 3.756032759746613*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"UP", "[", "n", "]"}], ".", 
    RowBox[{"UM", "[", "n", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749367454173129*^9, 3.749367467280079*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"U8", "=", 
   RowBox[{"U", "[", "8", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.758631676237047*^9, 3.75863168332222*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Time smeared observable", "Subsubsection",
 CellChangeTimes->{{3.675524202236849*^9, 3.675524210769371*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeSmearedObservable8", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Psi]\[Psi]N", "[", 
      RowBox[{"2", ",", "8"}], "]"}], "+", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"U8", ".", 
        RowBox[{"\[Psi]\[Psi]N", "[", 
         RowBox[{"2", ",", "8"}], "]"}], ".", 
        RowBox[{"HC", "[", "U8", "]"}]}], ",", "ass"}], "]"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675524239332864*^9, 3.675524329377191*^9}, 
   3.675577022151442*^9, 3.675586906646996*^9, 3.675587245380063*^9, 
   3.675587578781802*^9, {3.6755880758964863`*^9, 3.675588076208791*^9}, {
   3.678521053394174*^9, 3.678521058576325*^9}, {3.6834406189596024`*^9, 
   3.683440634796607*^9}, 3.6834414814765244`*^9, {3.683441513312956*^9, 
   3.683441514504327*^9}, {3.683455747561099*^9, 3.683455752714284*^9}, {
   3.683455800627049*^9, 3.683455822398011*^9}, {3.6835284126362743`*^9, 
   3.6835284130625687`*^9}, {3.683550229340332*^9, 3.683550243867326*^9}, 
   3.683551012747478*^9, {3.68355120644971*^9, 3.683551206754805*^9}, 
   3.683553213656981*^9, {3.758631716388238*^9, 3.758631746956028*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{"Flatten", "@", "timeSmearedObservable8"}], ",", "0"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.758633488371745*^9, 3.758633557476433*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.75863349997042*^9, 3.758633524058188*^9}, 
   3.758633558504241*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Y observable", "Subsubsection",
 CellChangeTimes->{{3.683440104325327*^9, 3.6834401106464243`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ObsY", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"U8", ".", 
     RowBox[{"\[Psi]\[Psi]N", "[", 
      RowBox[{"3", ",", "8"}], "]"}], ".", 
     RowBox[{"HC", "[", "U8", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683454939897634*^9, 3.6834549763687077`*^9}, {
  3.683455060587179*^9, 3.683455066751326*^9}, {3.683455523875758*^9, 
  3.683455536766775*^9}, {3.758631823150611*^9, 3.758631824114451*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"timeSmearedObservable8", ".", "ObsY"}], "-", 
    RowBox[{"ObsY", ".", "timeSmearedObservable8"}]}], "]"}], "\[Equal]", 
  RowBox[{"ConstantArray", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", 
     RowBox[{"256", ",", "256"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.683440123202899*^9, 3.6834402358519163`*^9}, {
  3.68344029516084*^9, 3.683440302201089*^9}, {3.7586324187149487`*^9, 
  3.758632452604342*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.683440140014964*^9, 3.683440185124681*^9}, 
   3.683440236076449*^9, 3.6834403029419603`*^9, 3.6834406396821136`*^9, 
   3.6834414889213657`*^9, 3.68344151898993*^9, 3.683443210548416*^9, 
   3.683443380521349*^9, {3.7586324231970253`*^9, 3.7586324531243553`*^9}, 
   3.758633351698204*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Projectors", "Subsubsection",
 CellChangeTimes->{{3.564060749681695*^9, 3.564060752223914*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeSmearedObservable8EigenSys", "=", 
   RowBox[{"Eigensystem", "[", "timeSmearedObservable8", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7586334633386497`*^9, 3.758633465238068*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeSmearedObservable8EigenSys", "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"N", "[", "timeSmearedObservable8", "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.56285254879998*^9, 3.5628525614068108`*^9}, {
   3.562993693650978*^9, 3.562993704020485*^9}, {3.564117983289029*^9, 
   3.564118010016862*^9}, {3.6755251182044*^9, 3.6755251763576107`*^9}, {
   3.683528062331855*^9, 3.683528064795013*^9}, {3.683546662158021*^9, 
   3.683546663506963*^9}, {3.6835468340551233`*^9, 3.68354686448458*^9}, {
   3.68354992244016*^9, 3.683549923744679*^9}, {3.683553229800703*^9, 
   3.683553231463381*^9}, 3.7586325213002567`*^9, {3.758632554870096*^9, 
   3.758632560781595*^9}, {3.758632657667282*^9, 3.758632664539158*^9}, {
   3.758633393651669*^9, 3.758633395810232*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timeSmearedObservable8EigenSys", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.758632624338595*^9, 3.758632655762609*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", 
   "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", 
   ",", "2", ",", "2", ",", "2", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.758632630406753*^9, 3.758632655764915*^9}, 
   3.7586334008800898`*^9, 3.758633685648386*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"TO8EigenSysApprox", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"SortBy", "[", 
     RowBox[{
      RowBox[{"SetPrecision", "[", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "timeSmearedObservable8EigenSys", "]"}], 
          ",", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "8"}], ")"}]}]}], "]"}], ",", "5"}], "]"}], ",", 
      "First"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68354707827287*^9, 3.683547082896571*^9}, {
   3.683547126289908*^9, 3.68354713174585*^9}, {3.683547177967773*^9, 
   3.68354728197164*^9}, {3.683547443439183*^9, 3.683547448512485*^9}, 
   3.758632564404467*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ES", "=", 
   RowBox[{"timeSmearedObservable8EigenSys", "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN", "=", "8"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"breaksL", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"2", "^", "NN"}]}], "}"}]}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Differences", "[", 
         RowBox[{"ES", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "m", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"breaksL", ",", "m"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"ES", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}], 
  ";", 
  RowBox[{"breaksL", "=", 
   RowBox[{"Sort", "@", "breaksL"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"subspacesL", "=", 
   RowBox[{
    RowBox[{"Length", "[", "breaksL", "]"}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Projectors", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"timeSmearedObservable8EigenSys", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "a"}], "]"}], "]"}], ",", 
            RowBox[{"CC", "[", 
             RowBox[{"timeSmearedObservable8EigenSys", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "a"}], "]"}], "]"}], "]"}]}], "]"}], ")"}], 
         "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"timeSmearedObservable8EigenSys", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "a"}], "]"}], "]"}], ".", 
           RowBox[{"CC", "[", 
            RowBox[{"timeSmearedObservable8EigenSys", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "a"}], "]"}], "]"}], "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{
           RowBox[{
           "breaksL", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
           "+", "1"}], ",", 
          RowBox[{"breaksL", "\[LeftDoubleBracket]", 
           RowBox[{"#", "+", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
       "]"}], "&"}], ",", 
     RowBox[{"{", "subspacesL", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SP", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SparseArray", "[", 
       RowBox[{"Projectors", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], ",", 
     RowBox[{"{", "subspacesL", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.6784443846321707`*^9, {3.678444487638089*^9, 3.6784445113974752`*^9}, 
   3.6784445719538393`*^9, {3.67844462409896*^9, 3.678444658548394*^9}, {
   3.6784447780601387`*^9, 3.678444840703426*^9}, {3.678444870867496*^9, 
   3.678444895910924*^9}, {3.678445029744969*^9, 3.678445057376893*^9}, {
   3.6784451230899563`*^9, 3.6784451268983173`*^9}, {3.6784452434809504`*^9, 
   3.678445366921865*^9}, 3.678445498904937*^9, 3.6784473307875347`*^9, {
   3.678518401396209*^9, 3.678518401433823*^9}, 3.678519602384029*^9, 
   3.678540394173316*^9, 3.6785404555055733`*^9, 3.6834554051232243`*^9, 
   3.6835472965202227`*^9, {3.683547404965201*^9, 3.683547489487568*^9}, {
   3.6835475694288673`*^9, 3.683547573917206*^9}, {3.6835477372054443`*^9, 
   3.6835477484092207`*^9}, {3.683549409632822*^9, 3.6835494149416523`*^9}, 
   3.683549932242804*^9, 3.683553239524107*^9, {3.7586337947744827`*^9, 
   3.758633816283557*^9}}],

Cell[CellGroupData[{

Cell[BoxData["subspacesL"], "Input",
 CellChangeTimes->{{3.758634197037022*^9, 3.7586342113762417`*^9}}],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.7586342118218718`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{"Flatten", "@", 
    RowBox[{
    "Projectors", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
   ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.758633949356474*^9, 3.7586342372423353`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"]}], "}"}]], "Output",
 CellChangeTimes->{{3.758634232924663*^9, 3.75863423785618*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
    "Projectors", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "subspacesL"}], "}"}]}], "]"}], "==", 
  RowBox[{"IdentityMatrix", "[", "256", "]"}]}]], "Input",
 CellChangeTimes->{{3.683629676981618*^9, 3.683629687859725*^9}, {
  3.758633934825077*^9, 3.758633941575231*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.683629633033534*^9, 3.683629689462517*^9, 
  3.758633942025289*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
    "Projectors", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "subspacesL"}], "}"}]}], "]"}], "==", 
  RowBox[{"IdentityMatrix", "[", "256", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"timeSmearedObservable8EigenSys", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{
        "breaksL", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}], 
        "+", "1"}]}], "\[RightDoubleBracket]"}], 
     RowBox[{
     "Projectors", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "subspacesL"}], "}"}]}], "]"}], "==", 
  "timeSmearedObservable8"}], "\[IndentingNewLine]", 
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
         "Projectors", "\[LeftDoubleBracket]", "#1", 
          "\[RightDoubleBracket]"}], ".", 
         RowBox[{
         "Projectors", "\[LeftDoubleBracket]", "#2", 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"#2", ",", "#1"}], "]"}], 
         RowBox[{
         "Projectors", "\[LeftDoubleBracket]", "#1", 
          "\[RightDoubleBracket]"}]}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"subspacesL", ",", "subspacesL"}], "}"}]}], "]"}], "]"}], ",", 
   "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6784455039608583`*^9, 3.678445552739156*^9}, {
   3.678446852661983*^9, 3.6784468581304893`*^9}, {3.6784469278072243`*^9, 
   3.678446928300571*^9}, {3.6784470098447313`*^9, 3.678447012108077*^9}, {
   3.67851465592318*^9, 3.678514672703107*^9}, {3.678514712092854*^9, 
   3.678514730255352*^9}, 3.6785149144259377`*^9, {3.678514954645494*^9, 
   3.678514967253963*^9}, {3.678515031930903*^9, 3.678515082675268*^9}, {
   3.678515115555126*^9, 3.678515128483328*^9}, {3.678519611130817*^9, 
   3.678519613080216*^9}, {3.683547321683425*^9, 3.683547332954373*^9}, 
   3.683547639503778*^9, {3.6835477603473797`*^9, 3.6835477718800173`*^9}, {
   3.683550092013259*^9, 3.683550097963306*^9}, 3.683629642356153*^9, {
   3.758634276514564*^9, 3.758634288656987*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pspec"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(a\\)\[NoBreak] is \
neither a machine-sized integer nor a list of machine-sized integers. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/pspec\\\", \
ButtonNote -> \\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.758634313443812*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pspec"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(a\\)\[NoBreak] is \
neither a machine-sized integer nor a list of machine-sized integers. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/pspec\\\", \
ButtonNote -> \\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.758634314110919*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{367., {2., 8.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{
           UnderoverscriptBox["\[Sum]", "a", "subspacesL"], 
           RowBox[{
           "Projectors", "\[LeftDoubleBracket]", "a", 
            "\[RightDoubleBracket]"}]}], "\[Equal]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
               ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
               ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
               ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
               ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
               ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
               ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
               ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
               ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
               ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
               ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"\[LeftSkeleton]", "255", "\[RightSkeleton]"}]}], "}"}]}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{63., {0., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 1, 26731661813672332158, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{67., {0., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 1, 26731661813672332158, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{104., {2., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 1, 26731661813672332158, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{97., {0., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[1]]], "Output",
 CellChangeTimes->{
  3.67844551081616*^9, 3.678446860758696*^9, 3.678446929362661*^9, 
   3.6784470128182783`*^9, 3.678447333260311*^9, 3.678449098689673*^9, 
   3.67844958482111*^9, 3.678449736694585*^9, 3.678514915309084*^9, 
   3.678515129433221*^9, 3.678515326372685*^9, 3.678519616152604*^9, 
   3.678519685321747*^9, 3.68328826844414*^9, 3.683441530594225*^9, 
   3.6834432366438932`*^9, 3.683443397102049*^9, 3.683446051134471*^9, 
   3.683455776701545*^9, 3.683547304299011*^9, 3.683547334339608*^9, 
   3.6835476090141068`*^9, 3.683547762303699*^9, 3.6835500988074913`*^9, {
   3.7586342901964617`*^9, 3.758634314248921*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pspec"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(a\\)\[NoBreak] is \
neither a machine-sized integer nor a list of machine-sized integers. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/pspec\\\", \
ButtonNote -> \\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7586343143506527`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pspec"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(1 + \\(\\(breaksL \
\[LeftDoubleBracket] a \[RightDoubleBracket]\\)\\)\\)\[NoBreak] is neither a \
machine-sized integer nor a list of machine-sized integers. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/pspec\\\", \
ButtonNote -> \\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7586343143517933`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pspec"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(a\\)\[NoBreak] is \
neither a machine-sized integer nor a list of machine-sized integers. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/pspec\\\", \
ButtonNote -> \\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.758634314352807*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
pspec\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.75863431435388*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   UnderoverscriptBox["\[Sum]", "a", "subspacesL"], 
   RowBox[{
    RowBox[{
    "Projectors", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}], " ", 
    RowBox[{"timeSmearedObservable8EigenSys", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", 
      RowBox[{"1", "+", 
       RowBox[{
       "breaksL", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}]}]}], 
     "\[RightDoubleBracket]"}]}]}], "\[Equal]", 
  "timeSmearedObservable8"}]], "Output",
 CellChangeTimes->{
  3.67844551081616*^9, 3.678446860758696*^9, 3.678446929362661*^9, 
   3.6784470128182783`*^9, 3.678447333260311*^9, 3.678449098689673*^9, 
   3.67844958482111*^9, 3.678449736694585*^9, 3.678514915309084*^9, 
   3.678515129433221*^9, 3.678515326372685*^9, 3.678519616152604*^9, 
   3.678519685321747*^9, 3.68328826844414*^9, 3.683441530594225*^9, 
   3.6834432366438932`*^9, 3.683443397102049*^9, 3.683446051134471*^9, 
   3.683455776701545*^9, 3.683547304299011*^9, 3.683547334339608*^9, 
   3.6835476090141068`*^9, 3.683547762303699*^9, 3.6835500988074913`*^9, {
   3.7586342901964617`*^9, 3.7586343144526978`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Array", "::", "ilsmn"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Single or list of non-negative machine-sized integers \
expected at position \[NoBreak]\\!\\(2\\)\[NoBreak] of \[NoBreak]\\!\\(Array[\
\\(\\(\\(\\(\\(\\(\\(\\(\\(\\(Projectors \[LeftDoubleBracket] #1 \
\[RightDoubleBracket]\\)\\) . \\(\\(Projectors \[LeftDoubleBracket] #2 \
\[RightDoubleBracket]\\)\\)\\)\\) - \\(\\(\\(\\(KroneckerDelta[\\(\\(#2, \
#1\\)\\)]\\)\\)\\\\ \\(\\(Projectors \[LeftDoubleBracket] #1 \
\[RightDoubleBracket]\\)\\)\\)\\)\\)\\) &\\)\\), \\(\\({subspacesL, \
subspacesL}\\)\\)\\)\\)]\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/ilsmn\\\", \
ButtonNote -> \\\"Array::ilsmn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.75863431445529*^9}],

Cell[BoxData[
 RowBox[{"Array", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "Projectors", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}], 
      ".", 
      RowBox[{
      "Projectors", "\[LeftDoubleBracket]", "#2", "\[RightDoubleBracket]"}]}],
      "-", 
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"#2", ",", "#1"}], "]"}], " ", 
      RowBox[{
      "Projectors", "\[LeftDoubleBracket]", "#1", 
       "\[RightDoubleBracket]"}]}]}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"subspacesL", ",", "subspacesL"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.67844551081616*^9, 3.678446860758696*^9, 3.678446929362661*^9, 
   3.6784470128182783`*^9, 3.678447333260311*^9, 3.678449098689673*^9, 
   3.67844958482111*^9, 3.678449736694585*^9, 3.678514915309084*^9, 
   3.678515129433221*^9, 3.678515326372685*^9, 3.678519616152604*^9, 
   3.678519685321747*^9, 3.68328826844414*^9, 3.683441530594225*^9, 
   3.6834432366438932`*^9, 3.683443397102049*^9, 3.683446051134471*^9, 
   3.683455776701545*^9, 3.683547304299011*^9, 3.683547334339608*^9, 
   3.6835476090141068`*^9, 3.683547762303699*^9, 3.6835500988074913`*^9, {
   3.7586342901964617`*^9, 3.758634314456151*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{"SP", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.683548230546371*^9, 3.683548271709271*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{2493, 1385},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 116, 1, 93, "Title"],
Cell[CellGroupData[{
Cell[721, 27, 103, 1, 81, "Section"],
Cell[CellGroupData[{
Cell[849, 32, 106, 1, 35, "Subsubsection"],
Cell[958, 35, 6744, 191, 539, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7739, 231, 103, 1, 35, "Subsubsection"],
Cell[7845, 234, 437, 13, 35, "Input"],
Cell[8285, 249, 550, 17, 35, "Input"],
Cell[CellGroupData[{
Cell[8860, 270, 179, 3, 32, "Input"],
Cell[9042, 275, 2096, 55, 35, "Output"]
}, Open  ]],
Cell[11153, 333, 165, 3, 31, "Text"],
Cell[11321, 338, 1245, 33, 121, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12603, 376, 180, 2, 35, "Subsubsection"],
Cell[12786, 380, 2880, 69, 121, "Input"],
Cell[CellGroupData[{
Cell[15691, 453, 187, 4, 32, "Input"],
Cell[15881, 459, 2282, 51, 284, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18212, 516, 118, 1, 35, "Subsubsection"],
Cell[18333, 519, 414, 7, 31, "Text"],
Cell[18750, 528, 556, 16, 32, "Input"],
Cell[19309, 546, 933, 25, 35, "Input"],
Cell[20245, 573, 208, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[20478, 581, 407, 11, 32, "Input"],
Cell[20888, 594, 171, 2, 32, "Output"]
}, Open  ]],
Cell[21074, 599, 241, 5, 31, "Text"],
Cell[CellGroupData[{
Cell[21340, 608, 651, 18, 32, "Input"],
Cell[21994, 628, 831, 21, 96, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22862, 654, 649, 18, 32, "Input"],
Cell[23514, 674, 1169, 24, 164, "Output"]
}, Open  ]],
Cell[24698, 701, 162, 3, 31, "Text"],
Cell[24863, 706, 374, 11, 32, "Input"],
Cell[25240, 719, 270, 7, 32, "Input"],
Cell[25513, 728, 107, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[25645, 733, 206, 4, 32, "Input"],
Cell[25854, 739, 2339, 52, 300, "Output"]
}, Open  ]],
Cell[28208, 794, 152, 2, 31, "Text"],
Cell[CellGroupData[{
Cell[28385, 800, 364, 9, 59, "Input"],
Cell[28752, 811, 286, 6, 35, "Output"]
}, Open  ]],
Cell[29053, 820, 127, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[29205, 825, 875, 25, 99, "Input"],
Cell[30083, 852, 262, 5, 35, "Output"],
Cell[30348, 859, 262, 5, 35, "Output"],
Cell[30613, 866, 262, 5, 35, "Output"],
Cell[30878, 873, 262, 5, 35, "Output"]
}, Open  ]],
Cell[31155, 881, 128, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[31308, 886, 1060, 30, 99, "Input"],
Cell[32371, 918, 286, 6, 35, "Output"],
Cell[32660, 926, 286, 6, 35, "Output"],
Cell[32949, 934, 286, 6, 35, "Output"],
Cell[33238, 942, 286, 6, 35, "Output"]
}, Open  ]],
Cell[33539, 951, 224, 3, 31, "Text"],
Cell[CellGroupData[{
Cell[33788, 958, 337, 9, 59, "Input"],
Cell[34128, 969, 257, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34422, 979, 809, 24, 99, "Input"],
Cell[35234, 1005, 252, 6, 35, "Output"],
Cell[35489, 1013, 232, 5, 35, "Output"],
Cell[35724, 1020, 234, 5, 35, "Output"],
Cell[35961, 1027, 232, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36230, 1037, 361, 9, 59, "Input"],
Cell[36594, 1048, 286, 6, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36917, 1059, 809, 24, 99, "Input"],
Cell[37729, 1085, 275, 6, 35, "Output"],
Cell[38007, 1093, 276, 6, 35, "Output"],
Cell[38286, 1101, 256, 5, 35, "Output"],
Cell[38545, 1108, 256, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38838, 1118, 388, 9, 59, "Input"],
Cell[39229, 1129, 287, 6, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39553, 1140, 809, 24, 99, "Input"],
Cell[40365, 1166, 276, 6, 35, "Output"],
Cell[40644, 1174, 278, 6, 35, "Output"],
Cell[40925, 1182, 276, 6, 35, "Output"],
Cell[41204, 1190, 256, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41497, 1200, 384, 9, 59, "Input"],
Cell[41884, 1211, 283, 6, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42204, 1222, 809, 24, 99, "Input"],
Cell[43016, 1248, 276, 6, 35, "Output"],
Cell[43295, 1256, 256, 5, 35, "Output"],
Cell[43554, 1263, 276, 6, 35, "Output"],
Cell[43833, 1271, 254, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44124, 1281, 218, 6, 32, "Input"],
Cell[44345, 1289, 2144, 49, 300, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46538, 1344, 191, 2, 35, "Subsubsection"],
Cell[46732, 1348, 166, 3, 31, "Text"],
Cell[46901, 1353, 341, 9, 77, "Input"],
Cell[47245, 1364, 492, 12, 77, "Input"],
Cell[47740, 1378, 135, 1, 31, "Text"],
Cell[47878, 1381, 1422, 41, 35, "Input"],
Cell[49303, 1424, 1114, 33, 55, "Input"],
Cell[50420, 1459, 313, 11, 31, "Text"],
Cell[50736, 1472, 489, 13, 55, "Input"],
Cell[51228, 1487, 122, 1, 31, "Text"],
Cell[51353, 1490, 250, 7, 32, "Input"],
Cell[51606, 1499, 120, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[51751, 1504, 309, 7, 77, "Input"],
Cell[52063, 1513, 2392, 52, 300, "Output"],
Cell[54458, 1567, 2451, 52, 300, "Output"],
Cell[56912, 1621, 2354, 51, 300, "Output"]
}, Open  ]],
Cell[59281, 1675, 172, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[59478, 1683, 355, 9, 55, "Input"],
Cell[59836, 1694, 560, 14, 32, "Output"],
Cell[60399, 1710, 3896, 87, 99, "Output"]
}, Open  ]],
Cell[64310, 1800, 173, 2, 31, "Text"],
Cell[CellGroupData[{
Cell[64508, 1806, 386, 9, 32, "Input"],
Cell[64897, 1817, 824, 20, 35, "Output"]
}, Open  ]],
Cell[65736, 1840, 186, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[65947, 1848, 587, 17, 55, "Input"],
Cell[66537, 1867, 2219, 50, 300, "Output"],
Cell[68759, 1919, 2219, 50, 300, "Output"]
}, Open  ]],
Cell[70993, 1972, 169, 2, 31, "Text"],
Cell[CellGroupData[{
Cell[71187, 1978, 633, 16, 55, "Input"],
Cell[71823, 1996, 193, 3, 32, "Output"],
Cell[72019, 2001, 193, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72249, 2009, 583, 15, 55, "Input"],
Cell[72835, 2026, 75, 1, 32, "Output"],
Cell[72913, 2029, 73, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73023, 2035, 515, 12, 32, "Input"],
Cell[73541, 2049, 3675, 85, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77253, 2139, 530, 14, 55, "Input"],
Cell[77786, 2155, 1376, 36, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79199, 2196, 899, 23, 32, "Input"],
Cell[80101, 2221, 1338, 36, 112, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81488, 2263, 120, 1, 35, "Subsubsection"],
Cell[81611, 2266, 495, 14, 55, "Input"],
Cell[82109, 2282, 141, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[82275, 2287, 515, 14, 55, "Input"],
Cell[82793, 2303, 142, 2, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82984, 2311, 339, 6, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[83348, 2321, 2893, 75, 239, "Input"],
Cell[86244, 2398, 1469, 38, 118, "Output"]
}, Open  ]],
Cell[87728, 2439, 3485, 90, 172, "Input"],
Cell[91216, 2531, 1861, 57, 92, "Input"],
Cell[93080, 2590, 2335, 65, 112, "Input"],
Cell[CellGroupData[{
Cell[95440, 2659, 184, 4, 31, "Input"],
Cell[95627, 2665, 123, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95787, 2672, 148, 3, 31, "Input"],
Cell[95938, 2677, 751, 21, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96726, 2703, 160, 3, 31, "Input"],
Cell[96889, 2708, 3932, 114, 424, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100858, 2827, 512, 11, 52, "Input"],
Cell[101373, 2840, 4783, 128, 464, "Output"],
Cell[106159, 2970, 3295, 80, 352, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109515, 3057, 203, 3, 81, "Section"],
Cell[CellGroupData[{
Cell[109743, 3064, 114, 1, 45, "Subsection"],
Cell[109860, 3067, 1061, 29, 55, "Input"],
Cell[110924, 3098, 663, 16, 55, "Input"],
Cell[111590, 3116, 117, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[111732, 3121, 824, 21, 55, "Input"],
Cell[112559, 3144, 245, 3, 32, "Output"],
Cell[112807, 3149, 245, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113089, 3157, 564, 15, 55, "Input"],
Cell[113656, 3174, 97, 1, 32, "Output"],
Cell[113756, 3177, 94, 1, 32, "Output"]
}, Open  ]],
Cell[113865, 3181, 121, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[114011, 3186, 533, 15, 37, "Input"],
Cell[114547, 3203, 147, 2, 32, "Output"]
}, Open  ]],
Cell[114709, 3208, 175, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[114909, 3216, 1859, 57, 112, "Input"],
Cell[116771, 3275, 96, 1, 32, "Output"],
Cell[116870, 3278, 100, 1, 32, "Output"],
Cell[116973, 3281, 100, 1, 32, "Output"],
Cell[117076, 3284, 99, 1, 32, "Output"]
}, Open  ]],
Cell[117190, 3288, 232, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[117447, 3296, 494, 14, 32, "Input"],
Cell[117944, 3312, 2161, 63, 82, "Output"]
}, Open  ]],
Cell[120120, 3378, 92, 1, 31, "Text"],
Cell[120215, 3381, 558, 16, 32, "Input"],
Cell[120776, 3399, 108, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[120909, 3404, 3768, 109, 143, "Input"],
Cell[124680, 3515, 495, 14, 38, "Output"],
Cell[125178, 3531, 364, 10, 32, "Output"],
Cell[125545, 3543, 462, 13, 38, "Output"]
}, Open  ]],
Cell[126022, 3559, 111, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[126158, 3564, 3692, 106, 143, "Input"],
Cell[129853, 3672, 443, 12, 38, "Output"],
Cell[130299, 3686, 336, 9, 32, "Output"],
Cell[130638, 3697, 432, 12, 38, "Output"]
}, Open  ]],
Cell[131085, 3712, 166, 3, 31, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131288, 3720, 210, 4, 45, "Subsection"],
Cell[131501, 3726, 162, 2, 31, "Text"],
Cell[131666, 3730, 1948, 57, 121, "Input"],
Cell[133617, 3789, 177, 2, 31, "Text"],
Cell[CellGroupData[{
Cell[133819, 3795, 1560, 48, 99, "Input"],
Cell[135382, 3845, 152, 2, 32, "Output"],
Cell[135537, 3849, 154, 2, 32, "Output"],
Cell[135694, 3853, 152, 2, 32, "Output"],
Cell[135849, 3857, 152, 2, 32, "Output"]
}, Open  ]],
Cell[136016, 3862, 104, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[136145, 3867, 2361, 70, 99, "Input"],
Cell[138509, 3939, 744, 20, 63, "Output"],
Cell[139256, 3961, 742, 20, 63, "Output"],
Cell[140001, 3983, 742, 20, 63, "Output"],
Cell[140746, 4005, 744, 20, 63, "Output"]
}, Open  ]],
Cell[141505, 4028, 491, 11, 31, "Text"],
Cell[141999, 4041, 352, 10, 32, "Input"],
Cell[142354, 4053, 132, 1, 31, "Text"],
Cell[142489, 4056, 107, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[142621, 4061, 289, 7, 32, "Input"],
Cell[142913, 4070, 187, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143137, 4079, 409, 13, 42, "Input"],
Cell[143549, 4094, 205, 5, 32, "Output"]
}, Open  ]],
Cell[143769, 4102, 1831, 51, 107, "Input"],
Cell[145603, 4155, 112, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[145740, 4160, 349, 9, 55, "Input"],
Cell[146092, 4171, 3908, 85, 332, "Output"],
Cell[150003, 4258, 3835, 84, 332, "Output"]
}, Open  ]],
Cell[153853, 4345, 176, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[154054, 4353, 1039, 31, 99, "Input"],
Cell[155096, 4386, 3893, 86, 332, "Output"],
Cell[158992, 4474, 3809, 84, 332, "Output"],
Cell[162804, 4560, 3884, 85, 332, "Output"],
Cell[166691, 4647, 3818, 85, 332, "Output"]
}, Open  ]],
Cell[170524, 4735, 206, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[170755, 4743, 685, 19, 55, "Input"],
Cell[171443, 4764, 125, 2, 32, "Output"],
Cell[171571, 4768, 123, 2, 32, "Output"]
}, Open  ]],
Cell[171709, 4773, 102, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[171836, 4778, 818, 20, 32, "Input"],
Cell[172657, 4800, 3419, 77, 316, "Output"]
}, Open  ]],
Cell[176091, 4880, 647, 15, 33, "Text"],
Cell[CellGroupData[{
Cell[176763, 4899, 286, 8, 32, "Input"],
Cell[177052, 4909, 413, 12, 49, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[177526, 4928, 100, 1, 81, "Section"],
Cell[CellGroupData[{
Cell[177651, 4933, 211, 3, 35, "Subsubsection"],
Cell[177865, 4938, 1568, 44, 121, "Input"],
Cell[CellGroupData[{
Cell[179458, 4986, 297, 6, 32, "Input"],
Cell[179758, 4994, 551, 15, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[180358, 5015, 113, 1, 35, "Subsubsection"],
Cell[180474, 5018, 166, 3, 31, "Text"],
Cell[180643, 5023, 293, 7, 77, "Input"],
Cell[180939, 5032, 414, 10, 77, "Input"],
Cell[181356, 5044, 135, 1, 31, "Text"],
Cell[181494, 5047, 1422, 41, 35, "Input"],
Cell[182919, 5090, 1114, 33, 55, "Input"],
Cell[184036, 5125, 313, 11, 31, "Text"],
Cell[184352, 5138, 489, 13, 55, "Input"],
Cell[184844, 5153, 122, 1, 31, "Text"],
Cell[184969, 5156, 250, 7, 32, "Input"],
Cell[185222, 5165, 162, 4, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185421, 5174, 114, 1, 35, "Subsubsection"],
Cell[185538, 5177, 1153, 23, 32, "Input"],
Cell[CellGroupData[{
Cell[186716, 5204, 207, 5, 32, "Input"],
Cell[186926, 5211, 2843, 39, 77, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[189818, 5256, 105, 1, 35, "Subsubsection"],
Cell[189926, 5259, 460, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[190411, 5273, 499, 12, 32, "Input"],
Cell[190913, 5287, 345, 5, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[191307, 5298, 101, 1, 35, "Subsubsection"],
Cell[191411, 5301, 227, 5, 32, "Input"],
Cell[191641, 5308, 818, 14, 32, "Input"],
Cell[CellGroupData[{
Cell[192484, 5326, 172, 3, 32, "Input"],
Cell[192659, 5331, 4391, 109, 77, "Output"]
}, Open  ]],
Cell[197065, 5443, 741, 19, 32, "Input"],
Cell[197809, 5464, 3778, 99, 165, "Input"],
Cell[CellGroupData[{
Cell[201612, 5567, 104, 1, 32, "Input"],
Cell[201719, 5570, 72, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201828, 5576, 272, 7, 32, "Input"],
Cell[202103, 5585, 8310, 259, 169, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210450, 5849, 405, 10, 32, "Input"],
Cell[210858, 5861, 120, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211015, 5868, 2384, 58, 77, "Input"],
Cell[213402, 5928, 501, 10, 24, "Message"],
Cell[213906, 5940, 501, 10, 24, "Message"],
Cell[214410, 5952, 8256, 180, 162, "Output"],
Cell[222669, 6134, 503, 10, 24, "Message"],
Cell[223175, 6146, 572, 11, 24, "Message"],
Cell[223750, 6159, 501, 10, 24, "Message"],
Cell[224254, 6171, 527, 11, 24, "Message"],
Cell[224784, 6184, 1135, 23, 62, "Output"],
Cell[225922, 6209, 899, 16, 24, "Message"],
Cell[226824, 6227, 1241, 29, 32, "Output"]
}, Open  ]],
Cell[228080, 6259, 178, 4, 32, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
